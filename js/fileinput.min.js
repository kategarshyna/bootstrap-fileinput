/*
 bootstrap-fileinput v4.4.2
 http://plugins.krajee.com/file-input

 Author: Kartik Visweswaran
 Copyright: 2014 - 2017, Kartik Visweswaran, Krajee.com

 Licensed under the BSD 3-Clause
 https://github.com/kartik-v/bootstrap-fileinput/blob/master/LICENSE.md
*/
(function(h){"function"===typeof define&&define.amd?define(["jquery"],h):"object"===typeof module&&module.exports?module.exports=h(require("jquery")):h(window.jQuery)})(function(h){h.fn.fileinputLocales={};h.fn.fileinputThemes={};String.prototype.setTokens=function(a){var b=this.toString(),c;for(c in a)if(a.hasOwnProperty(c)){var d=new RegExp("{"+c+"}","g");b=b.replace(d,a[c])}return b};var e={FRAMES:".kv-preview-thumb",SORT_CSS:"file-sortable",STYLE_SETTING:'style="width:{width};height:{height};"',
OBJECT_PARAMS:'<param name="controller" value="true" />\n<param name="allowFullScreen" value="true" />\n<param name="allowScriptAccess" value="always" />\n<param name="autoPlay" value="false" />\n<param name="autoStart" value="false" />\n<param name="quality" value="high" />\n',DEFAULT_PREVIEW:'<div class="file-preview-other">\n<span class="{previewFileIconClass}">{previewFileIcon}</span>\n</div>',MODAL_ID:"kvFileinputModal",MODAL_EVENTS:["show","shown","hide","hidden","loaded"],objUrl:window.URL||
window.webkitURL,compare:function(a,b,c){return void 0!==a&&(c?a===b:a.match(b))},isIE:function(a){if("Microsoft Internet Explorer"!==navigator.appName)return!1;if(10===a)return(new RegExp("msie\\s"+a,"i")).test(navigator.userAgent);var b=document.createElement("div");b.innerHTML="\x3c!--[if IE "+a+"]> <i></i> <![endif]--\x3e";a=b.getElementsByTagName("i").length;document.body.appendChild(b);b.parentNode.removeChild(b);return a},initModal:function(a){var b=h("body");b.length&&a.appendTo(b)},isEmpty:function(a,
b){return void 0===a||null===a||0===a.length||b&&""===h.trim(a)},isArray:function(a){return Array.isArray(a)||"[object Array]"===Object.prototype.toString.call(a)},ifSet:function(a,b,c){return b&&"object"===typeof b&&a in b?b[a]:c||""},cleanArray:function(a){a instanceof Array||(a=[]);return a.filter(function(a){return void 0!==a&&null!==a})},spliceArray:function(a,b){var c,d=0,f=[];if(!(a instanceof Array))return[];for(c=0;c<a.length;c++)c!==b&&(f[d]=a[c],d++);return f},getNum:function(a,b){b=b||
0;if("number"===typeof a)return a;"string"===typeof a&&(a=parseFloat(a));return isNaN(a)?b:a},hasFileAPISupport:function(){return!(!window.File||!window.FileReader)},hasDragDropSupport:function(){var a=document.createElement("div");return!e.isIE(9)&&(void 0!==a.draggable||void 0!==a.ondragstart&&void 0!==a.ondrop)},hasFileUploadSupport:function(){return e.hasFileAPISupport()&&window.FormData},hasBlobSupport:function(){try{return!!window.Blob&&!!new Blob}catch(a){return!1}},hasArrayBufferViewSupport:function(){try{return 100===
(new Blob([new Uint8Array(100)])).size}catch(a){return!1}},dataURI2Blob:function(a){var b=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,c=e.hasBlobSupport(),d;if(!((c||b)&&window.atob&&window.ArrayBuffer&&window.Uint8Array))return null;var f=0<=a.split(",")[0].indexOf("base64")?atob(a.split(",")[1]):decodeURIComponent(a.split(",")[1]);var g=new ArrayBuffer(f.length);var k=new Uint8Array(g);for(d=0;d<f.length;d+=1)k[d]=f.charCodeAt(d);a=a.split(",")[0].split(":")[1].split(";")[0];
if(c)return new Blob([e.hasArrayBufferViewSupport()?k:g],{type:a});b=new b;b.append(g);return b.getBlob(a)},addCss:function(a,b){a.removeClass(b).addClass(b)},getElement:function(a,b,c){return e.isEmpty(a)||e.isEmpty(a[b])?c:h(a[b])},uniqId:function(){return Math.round((new Date).getTime()+100*Math.random())},htmlEncode:function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},replaceTags:function(a,b){var c=a;if(!b)return c;
h.each(b,function(a,b){"function"===typeof b&&(b=b());c=c.split(a).join(b)});return c},cleanMemory:function(a){a=a.is("img")?a.attr("src"):a.find("source").attr("src");e.objUrl.revokeObjectURL(a)},findFileName:function(a){var b=a.lastIndexOf("/");-1===b&&(b=a.lastIndexOf("\\"));return a.split(a.substring(b,b+1)).pop()},checkFullScreen:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement},toggleFullScreen:function(a){var b=
document,c=b.documentElement;c&&a&&!e.checkFullScreen()?c.requestFullscreen?c.requestFullscreen():c.msRequestFullscreen?c.msRequestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.webkitRequestFullscreen&&c.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):b.exitFullscreen?b.exitFullscreen():b.msExitFullscreen?b.msExitFullscreen():b.mozCancelFullScreen?b.mozCancelFullScreen():b.webkitExitFullscreen&&b.webkitExitFullscreen()},moveArray:function(a,b,c){if(c>=a.length)for(var d=c-a.length;d--+
1;)a.push(void 0);a.splice(c,0,a.splice(b,1)[0]);return a},cleanZoomCache:function(a){var b=a.closest(".kv-zoom-cache-theme");b.length||(b=a.closest(".kv-zoom-cache"));b.remove()},setOrientation:function(a,b){var c=new DataView(a),d=0,f=1,g;if(!(65496!==c.getUint16(d)||2>a.length)){d+=2;for(g=c.byteLength;d<g-2;){var e=c.getUint16(d);d+=2;switch(e){case 65505:g=c.getUint16(d);g-=d;d+=2;break;case 274:f=c.getUint16(d+6,!1),g=0}}b&&b(f)}},validateOrientation:function(a,b){if(window.FileReader&&window.DataView){var c=
new FileReader,d;c.onloadend=function(){d=c.result;e.setOrientation(d,b)};c.readAsArrayBuffer(a)}},adjustOrientedImage:function(a,b){if(a.hasClass("is-portrait-gt4"))if(b)a.css({width:a.parent().height()});else{a.css({height:"auto",width:a.height()});var c=a.parent().offset().top;var d=a.offset().top;a.css("margin-top",c-d)}}};var I=function(a,b){this.$element=h(a);this._validate()&&(this.isPreviewable=e.hasFileAPISupport(),this.isIE9=e.isIE(9),this.isIE10=e.isIE(10),this.isPreviewable||this.isIE9?
(this._init(b),this._listen()):this.$element.removeClass("file-loading"))};I.prototype={constructor:I,_cleanup:function(){this.reader=null;this.formdata={};this.uploadCount=0;this.uploadStatus={};this.uploadLog=[];this.uploadAsyncCount=0;this.loadedImages=[];this.totalImagesCount=0;this.ajaxRequests=[];this.clearStack();this.fileInputCleared=!1;this.fileBatchCompleted=!0;this.isPreviewable||(this.showPreview=!1);this.cancelling=this.ajaxAborted=this.isError=!1},_init:function(a){var b=this,c=b.$element;
b.options=a;h.each(a,function(a,c){switch(a){case "minFileCount":case "maxFileCount":case "minFileSize":case "maxFileSize":case "maxFilePreviewSize":case "resizeImageQuality":case "resizeIfSizeMoreThan":case "progressUploadThreshold":case "initialPreviewCount":case "zoomModalHeight":case "minImageHeight":case "maxImageHeight":case "minImageWidth":case "maxImageWidth":b[a]=e.getNum(c);break;default:b[a]=c}});if(b.rtl){var d=b.previewZoomButtonIcons.prev;b.previewZoomButtonIcons.prev=b.previewZoomButtonIcons.next;
b.previewZoomButtonIcons.next=d}b._cleanup();b.$form=c.closest("form");b._initTemplateDefaults();b.uploadFileAttr=e.isEmpty(c.attr("name"))?"file_data":c.attr("name");d=b._getLayoutTemplate("progress");b.progressTemplate=d.replace("{class}",b.progressClass);b.progressCompleteTemplate=d.replace("{class}",b.progressCompleteClass);b.progressErrorTemplate=d.replace("{class}",b.progressErrorClass);b.dropZoneEnabled=e.hasDragDropSupport()&&b.dropZoneEnabled;b.isDisabled=c.attr("disabled")||c.attr("readonly");
b.isDisabled&&c.attr("disabled",!0);b.isUploadable=e.hasFileUploadSupport()&&!e.isEmpty(b.uploadUrl);b.isClickable=b.browseOnZoneClick&&b.showPreview&&(b.isUploadable&&b.dropZoneEnabled||!e.isEmpty(b.defaultPreviewContent));b.slug="function"===typeof a.slugCallback?a.slugCallback:b._slugDefault;b.mainTemplate=b.showCaption?b._getLayoutTemplate("main1"):b._getLayoutTemplate("main2");b.captionTemplate=b._getLayoutTemplate("caption");b.previewGenericTemplate=b._getPreviewTemplate("generic");b.resizeImage&&
(b.maxImageWidth||b.maxImageHeight)&&(b.imageCanvas=document.createElement("canvas"),b.imageCanvasContext=b.imageCanvas.getContext("2d"));e.isEmpty(c.attr("id"))&&c.attr("id",e.uniqId());b.namespace=".fileinput_"+c.attr("id").replace(/-/g,"_");void 0===b.$container?b.$container=b._createContainer():b._refreshContainer();d=b.$container;b.$dropZone=d.find(".file-drop-zone");b.$progress=d.find(".kv-upload-progress");b.$btnUpload=d.find(".fileinput-upload");b.$captionContainer=e.getElement(a,"elCaptionContainer",
d.find(".file-caption"));b.$caption=e.getElement(a,"elCaptionText",d.find(".file-caption-name"));b.$previewContainer=e.getElement(a,"elPreviewContainer",d.find(".file-preview"));b.$preview=e.getElement(a,"elPreviewImage",d.find(".file-preview-thumbnails"));b.$previewStatus=e.getElement(a,"elPreviewStatus",d.find(".file-preview-status"));b.$errorContainer=e.getElement(a,"elErrorContainer",b.$previewContainer.find(".kv-fileinput-error"));e.isEmpty(b.msgErrorClass)||e.addCss(b.$errorContainer,b.msgErrorClass);
b.$errorContainer.hide();b.previewInitId="preview-"+e.uniqId();b._initPreviewCache();b._initPreview(!0);b._initPreviewActions();b._setFileDropZoneTitle();c.removeClass("file-loading");c.attr("disabled")&&b.disable();b._initZoom()},_initTemplateDefaults:function(){var a=this;var b='<div id="'+e.MODAL_ID+'" class="file-zoom-dialog modal fade" tabindex="-1" aria-labelledby="'+e.MODAL_ID+'Label"></div>';var c='<div class="kv-preview-data file-preview-html" title="{caption}" '+e.STYLE_SETTING+">{data}</div>\n";
var d='<img src="{data}" class="file-preview-image kv-preview-data" title="{caption}" alt="{caption}" '+e.STYLE_SETTING+">\n";var f='<textarea class="kv-preview-data file-preview-text" title="{caption}" readonly '+e.STYLE_SETTING+">{data}</textarea>\n";var g='<video class="kv-preview-data file-preview-video" width="{width}" height="{height}" controls>\n<source src="{data}" type="{type}">\n'+e.DEFAULT_PREVIEW+"\n</video>\n";var k='<div class="file-preview-audio"><audio class="kv-preview-data" controls>\n<source src="{data}" type="{type}">\n'+
e.DEFAULT_PREVIEW+"\n</audio></div>\n";var l='<object class="kv-preview-data file-object" type="application/x-shockwave-flash" width="{width}" height="{height}" data="{data}">\n'+e.OBJECT_PARAMS+" "+e.DEFAULT_PREVIEW+"\n</object>\n";var n='<object class="kv-preview-data file-object {typeCss}" data="{data}" type="{type}" width="{width}" height="{height}">\n<param name="movie" value="{caption}" />\n'+e.OBJECT_PARAMS+" "+e.DEFAULT_PREVIEW+"\n</object>\n";var q='<div class="kv-preview-data file-preview-other-frame">\n'+
e.DEFAULT_PREVIEW+"\n</div>\n";var p={width:"100%",height:"100%","min-height":"480px"};a.defaults={layoutTemplates:{main1:'{preview}\n<div class="kv-upload-progress hide"></div>\n<div class="input-group {class}">\n   {caption}\n   <div class="input-group-btn">\n       {remove}\n       {cancel}\n       {upload}\n       {browse}\n   </div>\n</div>',main2:'{preview}\n<div class="kv-upload-progress hide"></div>\n{remove}\n{cancel}\n{upload}\n{browse}\n',preview:'<div class="file-preview {class}">\n    {close}    <div class="{dropClass}">\n    <div class="file-preview-thumbnails">\n    </div>\n    <div class="clearfix"></div>    <div class="file-preview-status text-center text-success"></div>\n    <div class="kv-fileinput-error"></div>\n    </div>\n</div>',
close:'<div class="close fileinput-remove">&times;</div>\n',fileIcon:'<i class="glyphicon glyphicon-file kv-caption-icon"></i>',caption:'<div tabindex="500" class="form-control file-caption {class}">\n   <div class="file-caption-name"></div>\n</div>\n',modalMain:b,modal:'<div class="modal-dialog modal-lg{rtl}" role="document">\n  <div class="modal-content">\n    <div class="modal-header">\n      <div class="kv-zoom-actions pull-right">{toggleheader}{fullscreen}{borderless}{close}</div>\n      <h3 class="modal-title">{heading} <small><span class="kv-zoom-title"></span></small></h3>\n    </div>\n    <div class="modal-body">\n      <div class="floating-buttons"></div>\n      <div class="kv-zoom-body file-zoom-content {zoomFrameClass}"></div>\n{prev} {next}\n    </div>\n  </div>\n</div>\n',
progress:'<div class="progress">\n    <div class="{class}" role="progressbar" aria-valuenow="{percent}" aria-valuemin="0" aria-valuemax="100" style="width:{percent}%;">\n        {status}\n     </div>\n</div>',size:" <samp>({sizeText})</samp>",footer:'<div class="file-thumbnail-footer">\n    <div class="file-footer-caption" title="{caption}">{caption}<br>{size}</div>\n    {progress} {indicator} {actions}\n</div>',indicator:'<div class="file-upload-indicator" title="{indicatorTitle}">{indicator}</div>',
actions:'{drag}\n<div class="file-actions">\n    <div class="file-footer-buttons">\n        {upload} {delete} {zoom} {other}    </div>\n    <div class="clearfix"></div>\n</div>',actionDelete:'<button type="button" class="kv-file-remove {removeClass}" title="{removeTitle}" {dataUrl}{dataKey}>{removeIcon}</button>\n',actionUpload:'<button type="button" class="kv-file-upload {uploadClass}" title="{uploadTitle}">{uploadIcon}</button>',actionZoom:'<button type="button" class="kv-file-zoom {zoomClass}" title="{zoomTitle}">{zoomIcon}</button>',
actionDrag:'<span class="file-drag-handle {dragClass}" title="{dragTitle}">{dragIcon}</span>',btnDefault:'<button type="{type}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</button>',btnLink:'<a href="{href}" tabindex="500" title="{title}" class="{css}" {status}>{icon} {label}</a>',btnBrowse:'<div tabindex="500" class="{css}" {status}>{icon} {label}</div>',zoomCache:'<div class="kv-zoom-cache" style="display:none">{zoomContent}</div>'},previewMarkupTags:{tagBefore1:'<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-template="{template}"><div class="kv-file-content">\n',
tagBefore2:'<div class="file-preview-frame {frameClass}" id="{previewId}" data-fileindex="{fileindex}" data-template="{template}" title="{caption}"><div class="kv-file-content">\n',tagAfter:"</div>{footer}\n</div>\n"},previewContentTemplates:{generic:"{content}\n",html:c,image:d,text:f,video:g,audio:k,flash:l,object:n,pdf:'<embed class="kv-preview-data" src="{data}" width="{width}" height="{height}" type="application/pdf">\n',other:q},allowedPreviewTypes:"image html text video audio flash pdf object".split(" "),
previewTemplates:{},previewSettings:{image:{width:"auto",height:"160px"},html:{width:"213px",height:"160px"},text:{width:"213px",height:"160px"},video:{width:"auto",height:"100%","max-width":"100%"},audio:{width:"100%",height:"30px"},flash:{width:"auto",height:"100%","max-width":"100%"},object:{height:"100%"},pdf:{width:"160px",height:"160px"},other:{width:"160px",height:"160px"}},previewZoomSettings:{image:{width:"auto",height:"auto","max-width":"100%","max-height":"100%"},html:p,text:p,video:{width:"auto",
height:"100%","max-width":"100%"},audio:{width:"100%",height:"30px"},flash:{width:"auto",height:"480px"},object:{width:"auto",height:"100%","max-width":"100%","min-height":"480px"},pdf:p,other:{width:"auto",height:"100%","min-height":"480px"}},fileTypeSettings:{image:function(a,b){return e.compare(a,"image.*")||e.compare(b,/\.(gif|png|jpe?g)$/i)},html:function(a,b){return e.compare(a,"text/html")||e.compare(b,/\.(htm|html)$/i)},text:function(a,b){return e.compare(a,"text.*")||e.compare(b,/\.(xml|javascript)$/i)||
e.compare(b,/\.(txt|md|csv|nfo|ini|json|php|js|css)$/i)},video:function(a,b){return e.compare(a,"video.*")&&(e.compare(a,/(ogg|mp4|mp?g|mov|webm|3gp)$/i)||e.compare(b,/\.(og?|mp4|webm|mp?g|mov|3gp)$/i))},audio:function(a,b){return e.compare(a,"audio.*")&&(e.compare(b,/(ogg|mp3|mp?g|wav)$/i)||e.compare(b,/\.(og?|mp3|mp?g|wav)$/i))},flash:function(a,b){return e.compare(a,"application/x-shockwave-flash",!0)||e.compare(b,/\.(swf)$/i)},pdf:function(a,b){return e.compare(a,"application/pdf",!0)||e.compare(b,
/\.(pdf)$/i)},object:function(){return!0},other:function(){return!0}},fileActionSettings:{showRemove:!0,showUpload:!0,showZoom:!0,showDrag:!0,removeIcon:'<i class="glyphicon glyphicon-trash text-danger"></i>',removeClass:"btn btn-xs btn-default",removeTitle:"Remove file",uploadIcon:'<i class="glyphicon glyphicon-upload text-info"></i>',uploadClass:"btn btn-xs btn-default",uploadTitle:"Upload file",zoomIcon:'<i class="glyphicon glyphicon-zoom-in"></i>',zoomClass:"btn btn-xs btn-default",zoomTitle:"View Details",
dragIcon:'<i class="glyphicon glyphicon-menu-hamburger"></i>',dragClass:"text-info",dragTitle:"Move / Rearrange",dragSettings:{},indicatorNew:'<i class="glyphicon glyphicon-hand-down text-warning"></i>',indicatorSuccess:'<i class="glyphicon glyphicon-ok-sign text-success"></i>',indicatorError:'<i class="glyphicon glyphicon-exclamation-sign text-danger"></i>',indicatorLoading:'<i class="glyphicon glyphicon-hand-up text-muted"></i>',indicatorNewTitle:"Not uploaded yet",indicatorSuccessTitle:"Uploaded",
indicatorErrorTitle:"Upload Error",indicatorLoadingTitle:"Uploading ..."}};h.each(a.defaults,function(b,c){"allowedPreviewTypes"===b?void 0===a.allowedPreviewTypes&&(a.allowedPreviewTypes=c):a[b]=h.extend(!0,{},c,a[b])});a._initPreviewTemplates()},_initPreviewTemplates:function(){var a=this,b=a.previewMarkupTags,c,d=b.tagAfter;h.each(a.defaults.previewContentTemplates,function(f,g){if(e.isEmpty(a.previewTemplates[f])){c=b.tagBefore2;if("generic"===f||"image"===f||"html"===f||"text"===f)c=b.tagBefore1;
a.previewTemplates[f]=c+g+d}})},_initPreviewCache:function(){var a=this;a.previewCache={data:{},init:function(){var b=a.initialPreview;0<b.length&&!e.isArray(b)&&(b=b.split(a.initialPreviewDelimiter));a.previewCache.data={content:b,config:a.initialPreviewConfig,tags:a.initialPreviewThumbTags}},fetch:function(){return a.previewCache.data.content.filter(function(a){return null!==a})},count:function(b){return a.previewCache.data&&a.previewCache.data.content?b?a.previewCache.data.content.length:a.previewCache.fetch().length:
0},get:function(b,c){var d="init_"+b,f=a.previewCache.data,g=f.config[b],k=f.content[b],l=a.previewInitId+"-"+d,n=e.ifSet("previewAsData",g,a.initialPreviewAsData),q=function(b,c,d,f,g,k,h,l,m){l=" file-preview-initial "+e.SORT_CSS+(l?" "+l:"");return a._generatePreviewTemplate(b,c,d,f,g,!1,null,l,k,h,m)};if(!k)return"";c=void 0===c?!0:c;var p=e.ifSet("type",g,a.initialPreviewFileType||"generic");var m=e.ifSet("filename",g,e.ifSet("caption",g));var u=e.ifSet("filetype",g,p);var r=a.previewCache.footer(b,
c,g&&g.size||null);var t=e.ifSet("frameClass",g);d=n?q(p,k,m,u,l,r,d,t):q("generic",k,m,u,l,r,d,t,p).setTokens({content:f.content[b]});f.tags.length&&f.tags[b]&&(d=e.replaceTags(d,f.tags[b]));e.isEmpty(g)||e.isEmpty(g.frameAttr)||(f=h(document.createElement("div")).html(d),f.find(".file-preview-initial").attr(g.frameAttr),d=f.html(),f.remove());return d},add:function(b,c,d,f){var g=a.previewCache.data;e.isArray(b)||(b=b.split(a.initialPreviewDelimiter));f?(f=g.content.push(b)-1,g.config[f]=c,g.tags[f]=
d):(f=b.length-1,g.content=b,g.config=c,g.tags=d);a.previewCache.data=g;return f},set:function(b,c,d,f){var g=a.previewCache.data;if(b&&b.length&&(e.isArray(b)||(b=b.split(a.initialPreviewDelimiter)),b.filter(function(a){return null!==a}).length)){void 0===g.content&&(g.content=[]);void 0===g.config&&(g.config=[]);void 0===g.tags&&(g.tags=[]);if(f){for(f=0;f<b.length;f++)b[f]&&g.content.push(b[f]);for(f=0;f<c.length;f++)c[f]&&g.config.push(c[f]);for(f=0;f<d.length;f++)d[f]&&g.tags.push(d[f])}else g.content=
b,g.config=c,g.tags=d;a.previewCache.data=g}},unset:function(b){var c=a.previewCache.count();c&&(1===c?(a.previewCache.data.content=[],a.previewCache.data.config=[],a.previewCache.data.tags=[],a.initialPreview=[],a.initialPreviewConfig=[],a.initialPreviewThumbTags=[]):(a.previewCache.data.content[b]=null,a.previewCache.data.config[b]=null,a.previewCache.data.tags[b]=null))},out:function(){var b="";var c=a.previewCache.count(!0);var d;if(0===c)return{content:"",caption:""};for(d=0;d<c;d++)b+=a.previewCache.get(d);
c=a._getMsgSelected(a.previewCache.count());return{content:b,caption:c}},footer:function(b,c,d){var f=a.previewCache.data;if(!f||!f.config||0===f.config.length||e.isEmpty(f.config[b]))return"";c=void 0===c?!0:c;var g=f.config[b];b=e.ifSet("caption",g);var f=e.ifSet("width",g,"auto"),k=e.ifSet("url",g,!1),h=e.ifSet("key",g,null),n=a.fileActionSettings,q=e.ifSet("showDelete",g,e.ifSet("showDelete",n,a.initialPreviewShowDelete||!1)),p=e.ifSet("showZoom",g,e.ifSet("showZoom",n,!0)),g=e.ifSet("showDrag",
g,e.ifSet("showDrag",n,!0));c=a._renderFileActions(!1,q,p,g,!1===k&&c,k,h,!0);return a._getLayoutTemplate("footer").setTokens({progress:a._renderThumbProgress(),actions:c,caption:b,size:a._getSize(d),width:f,indicator:""})}};a.previewCache.init()},_handler:function(a,b,c){var d=this.namespace;b=b.split(" ").join(d+" ")+d;if(a&&a.length)a.off(b).on(b,c)},_log:function(a){var b=this.$element.attr("id");b&&(a='"'+b+'": '+a);"undefined"!==typeof window.console.log?window.console.log(a):window.alert(a)},
_validate:function(){var a="file"===this.$element.attr("type");a||this._log('The input "type" must be set to "file" for initializing the "bootstrap-fileinput" plugin.');return a},_errorsExist:function(){if(this.$errorContainer.find("li").length)return!0;var a=h(document.createElement("div")).html(this.$errorContainer.html());a.find("span.kv-error-close").remove();a.find("ul").remove();return h.trim(a.text()).length?!0:!1},_errorHandler:function(a,b){var c=this,d=a.target.error,f=function(a){c._showError(a.replace("{name}",
b))};d.code===d.NOT_FOUND_ERR?f(c.msgFileNotFound):d.code===d.SECURITY_ERR?f(c.msgFileSecured):d.code===d.NOT_READABLE_ERR?f(c.msgFileNotReadable):d.code===d.ABORT_ERR?f(c.msgFilePreviewAborted):f(c.msgFilePreviewError)},_addError:function(a){var b=this.$errorContainer;a&&b.length&&(b.html(this.errorCloseButton+a),this._handler(b.find(".kv-error-close"),"click",function(){b.fadeOut("slow")}))},_resetErrors:function(a){var b=this.$errorContainer;this.isError=!1;this.$container.removeClass("has-error");
b.html("");a?b.fadeOut("slow"):b.hide()},_showFolderError:function(a){var b=this.$errorContainer;if(a){var c=this.msgFoldersNotAllowed.replace("{n}",a);this._addError(c);e.addCss(this.$container,"has-error");b.fadeIn(800);this._raise("filefoldererror",[a,c])}},_showUploadError:function(a,b,c){var d=this.$errorContainer;c=c||"fileuploaderror";var f=b&&b.id?'<li data-file-id="'+b.id+'">'+a+"</li>":"<li>"+a+"</li>";0===d.find("ul").length?this._addError("<ul>"+f+"</ul>"):d.find("ul").append(f);d.fadeIn(800);
this._raise(c,[b,a]);this.$container.removeClass("file-input-new");e.addCss(this.$container,"has-error");return!0},_showError:function(a,b,c){var d=this.$errorContainer;c=c||"fileerror";b=b||{};b.reader=this.reader;this._addError(a);d.fadeIn(800);this._raise(c,[b,a]);this.isUploadable||this._clearFileInput();this.$container.removeClass("file-input-new");e.addCss(this.$container,"has-error");this.$btnUpload.attr("disabled",!0);return!0},_noFilesError:function(a){var b=1<this.minFileCount?this.filePlural:
this.fileSingle,b=this.msgFilesTooLess.replace("{n}",this.minFileCount).replace("{files}",b),c=this.$errorContainer;this._addError(b);this.isError=!0;this._updateFileDetails(0);c.fadeIn(800);this._raise("fileerror",[a,b]);this._clearFileInput();e.addCss(this.$container,"has-error")},_parseError:function(a,b,c,d){c=h.trim(c+"");var f="."===c.slice(-1)?"":".";b=void 0!==b.responseJSON&&void 0!==b.responseJSON.error?b.responseJSON.error:b.responseText;this.cancelling&&this.msgUploadAborted&&(c=this.msgUploadAborted);
this.showAjaxErrorDetails&&b?(b=h.trim(b.replace(/\n\s*\n/g,"\n")),b=0<b.length?"<pre>"+b+"</pre>":"",c+=f+b):c+=f;c===f&&(c=this.msgAjaxError.replace("{operation}",a));this.cancelling=!1;return d?"<b>"+d+": </b>"+c:c},_parseFileType:function(a){var b,c=this.allowedPreviewTypes||[];for(b=0;b<c.length;b++){var d=c[b];var f=this.fileTypeSettings[d];f=f(a.type,a.name)?d:"";if(!e.isEmpty(f))return f}return"other"},_getPreviewIcon:function(a){var b=this,c=null;if(a&&-1<a.indexOf(".")){var d=a.split(".").pop();
b.previewFileIconSettings&&(c=b.previewFileIconSettings[d]||b.previewFileIconSettings[d.toLowerCase()]||null);b.previewFileExtSettings&&h.each(b.previewFileExtSettings,function(a,g){b.previewFileIconSettings[a]&&g(d)&&(c=b.previewFileIconSettings[a])})}return c},_parseFilePreviewIcon:function(a,b){var c=this._getPreviewIcon(b)||this.previewFileIcon,d=a;-1<d.indexOf("{previewFileIcon}")&&(d=d.setTokens({previewFileIconClass:this.previewFileIconClass,previewFileIcon:c}));return d},_raise:function(a,
b){var c=h.Event(a);void 0!==b?this.$element.trigger(c,b):this.$element.trigger(c);if(c.isDefaultPrevented()||!1===c.result)return!1;switch(a){case "filebatchuploadcomplete":case "filebatchuploadsuccess":case "fileuploaded":case "fileclear":case "filecleared":case "filereset":case "fileerror":case "filefoldererror":case "fileuploaderror":case "filebatchuploaderror":case "filedeleteerror":case "filecustomerror":case "filesuccessremove":break;default:this.ajaxAborted||(this.ajaxAborted=c.result)}return!0},
_listenFullScreen:function(a){var b=this.$modal;if(b&&b.length){var c=b&&b.find(".btn-fullscreen");var d=b&&b.find(".btn-borderless");c.length&&d.length&&(c.removeClass("active").attr("aria-pressed","false"),d.removeClass("active").attr("aria-pressed","false"),a?c.addClass("active").attr("aria-pressed","true"):d.addClass("active").attr("aria-pressed","true"),b.hasClass("file-zoom-fullscreen")?this._maximizeZoomDialog():a?this._maximizeZoomDialog():d.removeClass("active").attr("aria-pressed","false"))}},
_listen:function(){var a=this,b=a.$form,c=a.$container;a._handler(a.$element,"change",h.proxy(a._change,a));a.showBrowse&&a._handler(a.$btnFile,"click",h.proxy(a._browse,a));a._handler(c.find(".fileinput-remove:not([disabled])"),"click",h.proxy(a.clear,a));a._handler(c.find(".fileinput-cancel"),"click",h.proxy(a.cancel,a));a._initDragDrop();a._handler(b,"reset",h.proxy(a.reset,a));a.isUploadable||a._handler(b,"submit",h.proxy(a._submitForm,a));a._handler(a.$container.find(".fileinput-upload"),"click",
h.proxy(a._uploadClick,a));a._handler(h(window),"resize",function(){a._listenFullScreen(screen.width===window.innerWidth&&screen.height===window.innerHeight)});a._handler(h(document),"webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(){a._listenFullScreen(e.checkFullScreen())});a._initClickable()},_initClickable:function(){var a=this;if(a.isClickable){var b=a.isUploadable?a.$dropZone:a.$preview.find(".file-default-preview");e.addCss(b,"clickable");b.attr("tabindex",
-1);a._handler(b,"click",function(c){c=h(c.target);if(!c.parents(".file-preview-thumbnails").length||c.parents(".file-default-preview").length)a.$element.trigger("click"),b.blur()})}},_initDragDrop:function(){var a=this.$dropZone;this.isUploadable&&this.dropZoneEnabled&&this.showPreview&&(this._handler(a,"dragenter dragover",h.proxy(this._zoneDragEnter,this)),this._handler(a,"dragleave",h.proxy(this._zoneDragLeave,this)),this._handler(a,"drop",h.proxy(this._zoneDrop,this)),this._handler(h(document),
"dragenter dragover drop",this._zoneDragDropInit))},_zoneDragDropInit:function(a){a.stopPropagation();a.preventDefault()},_zoneDragEnter:function(a){var b=-1<h.inArray("Files",a.originalEvent.dataTransfer.types);this._zoneDragDropInit(a);this.isDisabled||!b?(a.originalEvent.dataTransfer.effectAllowed="none",a.originalEvent.dataTransfer.dropEffect="none"):e.addCss(this.$dropZone,"file-highlighted")},_zoneDragLeave:function(a){this._zoneDragDropInit(a);this.isDisabled||this.$dropZone.removeClass("file-highlighted")},
_zoneDrop:function(a){a.preventDefault();this.isDisabled||e.isEmpty(a.originalEvent.dataTransfer.files)||(this._change(a,"dragdrop"),this.$dropZone.removeClass("file-highlighted"))},_uploadClick:function(a){var b=this.$container.find(".fileinput-upload"),c=!b.hasClass("disabled")&&e.isEmpty(b.attr("disabled"));a&&a.isDefaultPrevented()||(this.isUploadable?(a.preventDefault(),c&&this.upload()):c&&"submit"!==b.attr("type")&&(b=b.closest("form"),b.length&&b.trigger("submit"),a.preventDefault()))},_submitForm:function(){return this._isFileSelectionValid()&&
!this._abort({})},_clearPreview:function(){var a=this.$preview;(this.showUploadedThumbs?this.getFrames(":not(.file-preview-success)"):this.getFrames()).each(function(){var b=h(this);b.remove();e.cleanZoomCache(a.find("#zoom-"+b.attr("id")))});this.getFrames().length&&this.showPreview||this._resetUpload();this._validateDefaultPreview()},_initSortable:function(){var a=this,b=a.$preview;var c="."+e.SORT_CSS;window.KvSortable&&0!==b.find(c).length&&(c={handle:".drag-handle-init",dataIdAttr:"data-preview-id",
scroll:!1,draggable:c,onSort:function(b){var c=b.oldIndex,d=b.newIndex;a.initialPreview=e.moveArray(a.initialPreview,c,d);a.initialPreviewConfig=e.moveArray(a.initialPreviewConfig,c,d);a.previewCache.init();for(var k=0;k<a.initialPreviewConfig.length;k++)if(null!==a.initialPreviewConfig[k]){var l=a.initialPreviewConfig[k].key;l=h(".kv-file-remove[data-key='"+l+"']").closest(e.FRAMES);l.attr("data-fileindex","init_"+k).attr("data-fileindex","init_"+k)}a._raise("filesorted",{previewId:h(b.item).attr("id"),
oldIndex:c,newIndex:d,stack:a.initialPreviewConfig})}},b.data("kvsortable")&&b.kvsortable("destroy"),h.extend(!0,c,a.fileActionSettings.dragSettings),b.kvsortable(c))},_initPreview:function(a){var b=this.initialCaption||"";if(this.previewCache.count()){var c=this.previewCache.out();b=a&&this.initialCaption?this.initialCaption:c.caption;this.$preview.html(c.content);this._setInitThumbAttr();this._setCaption(b);this._initSortable();e.isEmpty(c.content)||this.$container.removeClass("file-input-new")}else this._clearPreview(),
a?this._setCaption(b):this._initCaption()},_getZoomButton:function(a){var b=this.previewZoomButtonIcons[a],c=this.previewZoomButtonClasses[a],d=' title="'+(this.previewZoomButtonTitles[a]||"")+'" '+("close"===a?' data-dismiss="modal" aria-hidden="true"':"");if("fullscreen"===a||"borderless"===a||"toggleheader"===a)d+=' data-toggle="button" aria-pressed="false" autocomplete="off"';return'<button type="button" class="'+c+" btn-"+a+'"'+d+">"+b+"</button>"},_getModalContent:function(){return this._getLayoutTemplate("modal").setTokens({rtl:this.rtl?
" kv-rtl":"",zoomFrameClass:this.frameClass,heading:this.msgZoomModalHeading,prev:this._getZoomButton("prev"),next:this._getZoomButton("next"),toggleheader:this._getZoomButton("toggleheader"),fullscreen:this._getZoomButton("fullscreen"),borderless:this._getZoomButton("borderless"),close:this._getZoomButton("close")})},_listenModalEvent:function(a){var b=this,c=b.$modal;c.on(a+".bs.modal",function(d){var f=c.find(".btn-fullscreen"),g=c.find(".btn-borderless");b._raise("filezoom"+a,{sourceEvent:d,previewId:c.data("previewId"),
modal:c});"shown"===a&&(g.removeClass("active").attr("aria-pressed","false"),f.removeClass("active").attr("aria-pressed","false"),c.hasClass("file-zoom-fullscreen")&&(b._maximizeZoomDialog(),e.checkFullScreen()?f.addClass("active").attr("aria-pressed","true"):g.addClass("active").attr("aria-pressed","true")))})},_initZoom:function(){var a=this;var b=a._getLayoutTemplate("modalMain");var c="#"+e.MODAL_ID;a.showPreview&&(a.$modal=h(c),a.$modal&&a.$modal.length||(b=h(document.createElement("div")).html(b).insertAfter(a.$container),
a.$modal=h(c).insertBefore(b),b.remove()),e.initModal(a.$modal),a.$modal.html(a._getModalContent()),h.each(e.MODAL_EVENTS,function(b,c){a._listenModalEvent(c)}))},_initZoomButtons:function(){var a=this.$modal.data("previewId")||"";var b=this.getFrames().toArray();var c=b.length,d=this.$modal.find(".btn-prev"),f=this.$modal.find(".btn-next");if(2>b.length)d.hide(),f.hide();else if(d.show(),f.show(),c){var g=h(b[0]);b=h(b[c-1]);d.removeAttr("disabled");f.removeAttr("disabled");g.length&&g.attr("id")===
a&&d.attr("disabled",!0);b.length&&b.attr("id")===a&&f.attr("disabled",!0)}},_maximizeZoomDialog:function(){var a=this.$modal,b=a.find(".modal-header:visible"),c=a.find(".modal-footer:visible"),d=a.find(".modal-body"),f=h(window).height();a.addClass("file-zoom-fullscreen");b&&b.length&&(f-=b.outerHeight(!0));c&&c.length&&(f-=c.outerHeight(!0));d&&d.length&&(b=d.outerHeight(!0)-d.height(),f-=b);a.find(".kv-zoom-body").height(f)},_resizeZoomDialog:function(a){var b=this.$modal,c=b.find(".btn-fullscreen"),
d=b.find(".btn-borderless");if(b.hasClass("file-zoom-fullscreen"))(e.toggleFullScreen(!1),a)?c.hasClass("active")||(b.removeClass("file-zoom-fullscreen"),this._resizeZoomDialog(!0),d.hasClass("active")&&d.removeClass("active").attr("aria-pressed","false")):c.hasClass("active")?c.removeClass("active").attr("aria-pressed","false"):(b.removeClass("file-zoom-fullscreen"),this.$modal.find(".kv-zoom-body").css("height",this.zoomModalHeight));else{if(!a){this._maximizeZoomDialog();return}e.toggleFullScreen(!0)}b.focus()},
_setZoomContent:function(a,b){var c=this,d=a.attr("id"),f=c.$modal,g=f.find(".btn-prev"),k=f.find(".btn-next"),l=f.find(".btn-fullscreen"),n=f.find(".btn-borderless"),q=f.find(".btn-toggleheader");var p=c.$preview.find("#zoom-"+d);var m=p.attr("data-template")||"generic";p=p.find(".kv-file-content");p=p.length?p.html():"";var u=a.data("caption")||"";var r=a.data("size")||"";u=u+" "+r;f.find(".kv-zoom-title").html(u);var t=f.find(".kv-zoom-body");f.removeClass("kv-single-content");if(b){var w=t.addClass("file-thumb-loading").clone().insertAfter(t);
t.html(p).hide();w.fadeOut("fast",function(){t.fadeIn("fast",function(){t.removeClass("file-thumb-loading")});w.remove()})}else t.html(p);if(m=c.previewZoomSettings[m]){var y=t.find(".kv-preview-data");e.addCss(y,"file-zoom-detail");h.each(m,function(a,b){y.css(a,b);(y.attr("width")&&"width"===a||y.attr("height")&&"height"===a)&&y.removeAttr(a)})}f.data("previewId",d);m=t.find("img");m.length&&e.adjustOrientedImage(m,!0);c._handler(g,"click",function(){c._zoomSlideShow("prev",d)});c._handler(k,"click",
function(){c._zoomSlideShow("next",d)});c._handler(l,"click",function(){c._resizeZoomDialog(!0)});c._handler(n,"click",function(){c._resizeZoomDialog(!1)});c._handler(q,"click",function(){var a=f.find(".modal-header"),b=f.find(".modal-body .floating-buttons"),d=a.find(".kv-zoom-actions"),g=function(b){var d=c.$modal.find(".kv-zoom-body"),g=c.zoomModalHeight;f.hasClass("file-zoom-fullscreen")&&(g=d.outerHeight(!0),b||(g-=a.outerHeight(!0)));d.css("height",b?g+b:g)};if(a.is(":visible")){var e=a.outerHeight(!0);
a.slideUp("slow",function(){d.find(".btn").appendTo(b);g(e)})}else b.find(".btn").appendTo(d),a.slideDown("slow",function(){g()});f.focus()});c._handler(f,"keydown",function(a){a=a.which||a.keyCode;37!==a||g.attr("disabled")||c._zoomSlideShow("prev",d);39!==a||k.attr("disabled")||c._zoomSlideShow("next",d)})},_zoomPreview:function(a){var b=this.$modal;if(!a.length)throw"Cannot zoom to detailed preview!";e.initModal(b);b.html(this._getModalContent());a=a.closest(e.FRAMES);this._setZoomContent(a);b.modal("show");
this._initZoomButtons()},_zoomSlideShow:function(a,b){var c=this.$modal.find(".kv-zoom-actions .btn-"+a);var d=this.getFrames().toArray();var f=d.length;if(!c.attr("disabled")){for(c=0;c<f;c++)if(h(d[c]).attr("id")===b){var g="prev"===a?c-1:c+1;break}0>g||g>=f||!d[g]||(d=h(d[g]),d.length&&this._setZoomContent(d,!0),this._initZoomButtons(),this._raise("filezoom"+a,{previewId:b,modal:this.$modal}))}},_initZoomButton:function(){var a=this;a.$preview.find(".kv-file-zoom").each(function(){var b=h(this);
a._handler(b,"click",function(){a._zoomPreview(b)})})},_clearObjects:function(a){a.find("video audio").each(function(){this.pause();h(this).remove()});a.find("img object div").each(function(){h(this).remove()})},_clearFileInput:function(){var a=this.$element;this.fileInputCleared=!0;if(!e.isEmpty(a.val()))if(this.isIE9||this.isIE10){var b=a.closest("form");var c=h(document.createElement("form"));var d=h(document.createElement("div"));a.before(d);b.length?b.after(c):d.after(c);c.append(a).trigger("reset");
d.before(a).remove();c.remove()}else a.val("")},_resetUpload:function(){this.uploadCache={content:[],config:[],tags:[],append:!0};this.uploadCount=0;this.uploadStatus={};this.uploadLog=[];this.uploadAsyncCount=0;this.loadedImages=[];this.totalImagesCount=0;this.$btnUpload.removeAttr("disabled");this._setProgress(0);e.addCss(this.$progress,"hide");this._resetErrors(!1);this.ajaxAborted=!1;this.ajaxRequests=[];this._resetCanvas();this.cacheInitialPreview={};this.overwriteInitial&&(this.initialPreview=
[],this.initialPreviewConfig=[],this.initialPreviewThumbTags=[],this.previewCache.data={content:[],config:[],tags:[]})},_resetCanvas:function(){this.canvas&&this.imageCanvasContext&&this.imageCanvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)},_hasInitialPreview:function(){return!this.overwriteInitial&&this.previewCache.count()},_resetPreview:function(){if(this.previewCache.count()){var a=this.previewCache.out();this.$preview.html(a.content);this._setInitThumbAttr();a=this.initialCaption?
this.initialCaption:a.caption;this._setCaption(a)}else this._clearPreview(),this._initCaption();this.showPreview&&(this._initZoom(),this._initSortable())},_clearDefaultPreview:function(){this.$preview.find(".file-default-preview").remove()},_validateDefaultPreview:function(){this.showPreview&&!e.isEmpty(this.defaultPreviewContent)&&(this.$preview.html('<div class="file-default-preview">'+this.defaultPreviewContent+"</div>"),this.$container.removeClass("file-input-new"),this._initClickable())},_resetPreviewThumbs:function(a){a?
(this._clearPreview(),this.clearStack()):this._hasInitialPreview()?(a=this.previewCache.out(),this.$preview.html(a.content),this._setInitThumbAttr(),this._setCaption(a.caption),this._initPreviewActions()):this._clearPreview()},_getLayoutTemplate:function(a){a=this.layoutTemplates[a];return e.isEmpty(this.customLayoutTags)?a:e.replaceTags(a,this.customLayoutTags)},_getPreviewTemplate:function(a){a=this.previewTemplates[a];return e.isEmpty(this.customPreviewTags)?a:e.replaceTags(a,this.customPreviewTags)},
_getOutData:function(a,b,c){a=a||{};b=b||{};c=c||this.filestack.slice(0)||{};return{form:this.formdata,files:c,filenames:this.filenames,filescount:this.getFilesCount(),extra:this._getExtraData(),response:b,reader:this.reader,jqXHR:a}},_getMsgSelected:function(a){var b=1===a?this.fileSingle:this.filePlural;return 0<a?this.msgSelected.replace("{n}",a).replace("{files}",b):this.msgNoFilesSelected},_getFrame:function(a){var b=h("#"+a);return b.length?b:(this._log('Invalid thumb frame with id: "'+a+'".'),
null)},_getThumbs:function(a){return this.getFrames(":not(.file-preview-initial)"+(a||""))},_getExtraData:function(a,b){var c=this.uploadExtraData;"function"===typeof this.uploadExtraData&&(c=this.uploadExtraData(a,b));return c},_initXhr:function(a,b,c){var d=this;a.upload&&a.upload.addEventListener("progress",function(a){var f=0,e=a.total,h=a.loaded||a.position;a.lengthComputable&&(f=Math.floor(h/e*100));b?d._setAsyncUploadStatus(b,f,c):d._setProgress(f)},!1);return a},_ajaxSubmit:function(a,b,c,
d,f,g){var e=this;e._raise("filepreajax",[f,g])&&(e._uploadExtra(f,g),a=h.extend(!0,{},{xhr:function(){var a=h.ajaxSettings.xhr();return e._initXhr(a,f,e.getFileStack().length)},url:e.uploadUrl,type:"POST",dataType:"json",data:e.formdata,cache:!1,processData:!1,contentType:!1,beforeSend:a,success:b,complete:c,error:d},e.ajaxSettings),e.ajaxRequests.push(h.ajax(a)))},_mergeArray:function(a,b){var c=e.cleanArray(this[a]),d=e.cleanArray(b);this[a]=c.concat(d)},_initUploadSuccess:function(a,b,c){var d=
this;if(d.showPreview&&"object"===typeof a&&!h.isEmptyObject(a)&&void 0!==a.initialPreview&&0<a.initialPreview.length){d.hasInitData=!0;var f=a.initialPreview||[];var g=a.initialPreviewConfig||[];var k=a.initialPreviewThumbTags||[];a=void 0===a.append||a.append?!0:!1;0<f.length&&!e.isArray(f)&&(f=f.split(d.initialPreviewDelimiter));d._mergeArray("initialPreview",f);d._mergeArray("initialPreviewConfig",g);d._mergeArray("initialPreviewThumbTags",k);if(void 0!==b)if(c)c=b.attr("data-fileindex"),d.uploadCache.content[c]=
f[0],d.uploadCache.config[c]=g[0]||[],d.uploadCache.tags[c]=k[0]||[],d.uploadCache.append=a;else{f=d.previewCache.add(f,g[0],k[0],a);f=d.previewCache.get(f,!1);var l=h(document.createElement("div")).html(f).hide().insertAfter(b);(f=l.find(".kv-zoom-cache"))&&f.length&&f.insertAfter(b);b.fadeOut("slow",function(){var a=l.find(".file-preview-frame");a&&a.length&&a.insertBefore(b).fadeIn("slow").css("display:inline-block");d._initPreviewActions();d._clearFileInput();e.cleanZoomCache(d.$preview.find("#zoom-"+
b.attr("id")));b.remove();l.remove();d._initSortable()})}else d.previewCache.set(f,g,k,a),d._initPreview(),d._initPreviewActions()}},_initSuccessThumbs:function(){var a=this;a.showPreview&&a._getThumbs(e.FRAMES+".file-preview-success").each(function(){var b=h(this),c=a.$preview,d=b.find(".kv-file-remove");d.removeAttr("disabled");a._handler(d,"click",function(){var d=b.attr("id"),g=a._raise("filesuccessremove",[d,b.attr("data-fileindex"),b]);e.cleanMemory(b);!1!==g&&b.fadeOut("slow",function(){e.cleanZoomCache(c.find("#zoom-"+
d));b.remove();a.getFrames().length||a.reset()})})})},_checkAsyncComplete:function(){var a;for(a=0;a<this.filestack.length;a++)if(this.filestack[a]){var b=this.previewInitId+"-"+a;if(-1===h.inArray(b,this.uploadLog))return!1}return this.uploadAsyncCount===this.uploadLog.length},_uploadExtra:function(a,b){var c=this,d=c._getExtraData(a,b);0!==d.length&&h.each(d,function(a,b){c.formdata.append(a,b)})},_uploadSingle:function(a,b,c){var d=this,f=d.getFileStack().length,g=new FormData,k,l=d.previewInitId+
"-"+a,n=0<d.filestack.length||!h.isEmptyObject(d.uploadExtraData),q=h("#"+l).find(".file-thumb-progress"),p={id:l,index:a};d.formdata=g;if(d.showPreview){var m=h("#"+l+":not(.file-preview-initial)");var u=m.find(".kv-file-upload");var r=m.find(".kv-file-remove");q.removeClass("hide")}if(!(0===f||!n||u&&u.hasClass("disabled")||d._abort(p))){var t=function(a,b){d.updateStack(a,void 0);d.uploadLog.push(b);d._checkAsyncComplete()&&(d.fileBatchCompleted=!0)};var w=function(){var a=d.uploadCache,b,c,f,
g=0,h=d.cacheInitialPreview;d.fileBatchCompleted&&(h&&h.content&&(g=h.content.length),setTimeout(function(){if(d.showPreview){d.previewCache.set(a.content,a.config,a.tags,a.append);if(g){for(c=0;c<a.content.length;c++)f=c+g,h.content[f]=a.content[c],h.config.length&&(h.config[f]=a.config[c]),h.tags.length&&(h.tags[f]=a.tags[c]);d.initialPreview=e.cleanArray(h.content);d.initialPreviewConfig=e.cleanArray(h.config);d.initialPreviewThumbTags=e.cleanArray(h.tags)}else d.initialPreview=a.content,d.initialPreviewConfig=
a.config,d.initialPreviewThumbTags=a.tags;d.cacheInitialPreview={};d.hasInitData&&(d._initPreview(),d._initPreviewActions())}d.unlock();d._clearFileInput();b=d.$preview.find(".file-preview-initial");d.uploadAsync&&b.length&&(e.addCss(b,e.SORT_CSS),d._initSortable());d._raise("filebatchuploadcomplete",[d.filestack,d._getExtraData()]);d.uploadCount=0;d.uploadStatus={};d.uploadLog=[];d._setProgress(101)},100))};g.append(d.uploadFileAttr,b[a],d.filenames[a]);g.append("file_id",a);d._ajaxSubmit(function(b){k=
d._getOutData(b);d.fileBatchCompleted=!1;d.showPreview&&(m.hasClass("file-preview-success")||(d._setThumbStatus(m,"Loading"),e.addCss(m,"file-uploading")),u.attr("disabled",!0),r.attr("disabled",!0));c||d.lock();d._raise("filepreupload",[k,l,a]);h.extend(!0,p,k);d._abort(p)&&(b.abort(),d._setProgressCancelled())},function(b,f,g){var n=d.showPreview&&m.attr("id")?m.attr("id"):l;k=d._getOutData(g,b);h.extend(!0,p,k);setTimeout(function(){e.isEmpty(b)||e.isEmpty(b.error)?(d.showPreview&&(d._setThumbStatus(m,
"Success"),u.hide(),d._initUploadSuccess(b,m,c),d._setProgress(101,q)),d._raise("fileuploaded",[k,n,a,m]),c?t(a,n):d.updateStack(a,void 0)):(d._showUploadError(b.error,p),d._setPreviewError(m,a),c&&t(a,n))},100)},function(){setTimeout(function(){d.showPreview&&(u.removeAttr("disabled"),r.removeAttr("disabled"),m.removeClass("file-uploading"));c?w():(d.unlock(!1),d._clearFileInput());d._initSuccessThumbs()},100)},function(f,e,g){var k=d.ajaxOperations.uploadThumb,n=d._parseError(k,f,g,c?b[a].name:
null);setTimeout(function(){c&&t(a,l);d.uploadStatus[l]=100;d._setPreviewError(m,a);h.extend(!0,p,d._getOutData(f));d._setProgress(101,q,d.msgAjaxProgressError.replace("{operation}",k));d._showUploadError(n,p)},100)},l,a)}},_uploadBatch:function(){var a=this,b=a.filestack,c=b.length,d={},f=0<a.filestack.length||!h.isEmptyObject(a.uploadExtraData);a.formdata=new FormData;if(0!==c&&f&&!a._abort(d)){var g=function(){h.each(b,function(b){a.updateStack(b,void 0)});a._clearFileInput()};h.each(b,function(c,
d){e.isEmpty(b[c])||a.formdata.append(a.uploadFileAttr,d,a.filenames[c])});a._ajaxSubmit(function(b){a.lock();var c=a._getOutData(b);a.showPreview&&a._getThumbs().each(function(){var b=h(this),c=b.find(".kv-file-upload"),d=b.find(".kv-file-remove");b.hasClass("file-preview-success")||(a._setThumbStatus(b,"Loading"),e.addCss(b,"file-uploading"));c.attr("disabled",!0);d.attr("disabled",!0)});a._raise("filebatchpreupload",[c]);a._abort(c)&&(b.abort(),a._setProgressCancelled())},function(b,c,d){c=a._getOutData(d,
b);d=a._getThumbs(":not(.file-preview-error)");var f=0,k=e.isEmpty(b)||e.isEmpty(b.errorkeys)?[]:b.errorkeys;e.isEmpty(b)||e.isEmpty(b.error)?(a._raise("filebatchuploadsuccess",[c]),g(),a.showPreview?(d.each(function(){var b=h(this),c=b.find(".kv-file-upload");b.find(".kv-file-upload").hide();a._setThumbStatus(b,"Success");b.removeClass("file-uploading");c.removeAttr("disabled")}),a._initUploadSuccess(b)):a.reset(),a._setProgress(101)):(a.showPreview&&(d.each(function(){var b=h(this),c=b.find(".kv-file-remove"),
d=b.find(".kv-file-upload");b.removeClass("file-uploading");d.removeAttr("disabled");c.removeAttr("disabled");0===k.length?a._setPreviewError(b):(-1!==h.inArray(f,k)?a._setPreviewError(b):(b.find(".kv-file-upload").hide(),a._setThumbStatus(b,"Success"),a.updateStack(f,void 0)),f++)}),a._initUploadSuccess(b)),a._showUploadError(b.error,c,"filebatchuploaderror"))},function(){a.unlock();a._initSuccessThumbs();a._clearFileInput();a._raise("filebatchuploadcomplete",[a.filestack,a._getExtraData()])},function(b,
d,f){d=a._getOutData(b);var e=a.ajaxOperations.uploadBatch;b=a._parseError(e,b,f);a._showUploadError(b,d,"filebatchuploaderror");a.uploadFileCount=c-1;a.showPreview&&(a._getThumbs().each(function(){var b=h(this),c=b.attr("data-fileindex");b.removeClass("file-uploading");void 0!==a.filestack[c]&&a._setPreviewError(b)}),a._getThumbs().removeClass("file-uploading"),a._getThumbs(" .kv-file-upload").removeAttr("disabled"),a._getThumbs(" .kv-file-delete").removeAttr("disabled"),a._setProgress(101,a.$progress,
a.msgAjaxProgressError.replace("{operation}",e)))})}},_uploadExtraOnly:function(){var a=this,b={};a.formdata=new FormData;a._abort(b)||a._ajaxSubmit(function(c){a.lock();var d=a._getOutData(c);a._raise("filebatchpreupload",[d]);a._setProgress(50);b.data=d;b.xhr=c;a._abort(b)&&(c.abort(),a._setProgressCancelled())},function(b,d,f){d=a._getOutData(f,b);e.isEmpty(b)||e.isEmpty(b.error)?(a._raise("filebatchuploadsuccess",[d]),a._clearFileInput(),a._initUploadSuccess(b),a._setProgress(101)):a._showUploadError(b.error,
d,"filebatchuploaderror")},function(){a.unlock();a._clearFileInput();a._raise("filebatchuploadcomplete",[a.filestack,a._getExtraData()])},function(c,d,f){d=a._getOutData(c);var e=a.ajaxOperations.uploadExtra;c=a._parseError(e,c,f);b.data=d;a._showUploadError(c,d,"filebatchuploaderror");a._setProgress(101,a.$progress,a.msgAjaxProgressError.replace("{operation}",e))})},_deleteFileIndex:function(a){var b=a.attr("data-fileindex");"init_"===b.substring(0,5)&&(b=parseInt(b.replace("init_","")),this.initialPreview=
e.spliceArray(this.initialPreview,b),this.initialPreviewConfig=e.spliceArray(this.initialPreviewConfig,b),this.initialPreviewThumbTags=e.spliceArray(this.initialPreviewThumbTags,b),this.getFrames().each(function(){var a=h(this),d=a.attr("data-fileindex");"init_"===d.substring(0,5)&&(d=parseInt(d.replace("init_","")),d>b&&(d--,a.attr("data-fileindex","init_"+d)))}),this.uploadAsync&&(this.cacheInitialPreview=this.getPreview()))},_initFileActions:function(){var a=this,b=a.$preview;a.showPreview&&(a._initZoomButton(),
a.getFrames(" .kv-file-remove").each(function(){var c=h(this),d=c.closest(e.FRAMES),f,g=d.attr("id"),k=d.attr("data-fileindex"),l,n,q;a._handler(c,"click",function(){q=a._raise("filepreremove",[g,k]);if(!1===q||!a._validateMinCount())return!1;f=d.hasClass("file-preview-error");e.cleanMemory(d);d.fadeOut("slow",function(){e.cleanZoomCache(b.find("#zoom-"+g));a.updateStack(k,void 0);a._clearObjects(d);d.remove();g&&f&&a.$errorContainer.find('li[data-file-id="'+g+'"]').fadeOut("fast",function(){h(this).remove();
a._errorsExist()||a._resetErrors()});a._clearFileInput();var c=a.getFileStack(!0),m=a.previewCache.count(),q=c.length,r=a.showPreview&&a.getFrames().length;0!==q||0!==m||r?(l=m+q,n=1<l?a._getMsgSelected(l):c[0]?a._getFileNames()[0]:"",a._setCaption(n)):a.reset();a._raise("fileremoved",[g,k])})})}),a.getFrames(" .kv-file-upload").each(function(){var b=h(this);a._handler(b,"click",function(){var c=b.closest(e.FRAMES),f=c.attr("data-fileindex");c.hasClass("file-preview-error")||a._uploadSingle(f,a.filestack,
!1)})}))},_initPreviewActions:function(){var a=this,b=a.$preview,c=a.deleteExtraData||{},d=e.FRAMES+" .kv-file-remove",f=function(){var c=a.isUploadable?a.previewCache.count():a.$element.get(0).files.length;0!==b.find(d).length||c||(a.reset(),a.initialCaption="")};a._initZoomButton();b.find(d).each(function(){var d=h(this),k=d.data("url")||a.deleteUrl,l=d.data("key");if(!e.isEmpty(k)&&void 0!==l){var n=d.closest(e.FRAMES),q=a.previewCache.data,p=n.attr("data-fileindex"),p=parseInt(p.replace("init_",
"")),q=e.isEmpty(q.config)&&e.isEmpty(q.config[p])?null:q.config[p];var m=e.isEmpty(q)||e.isEmpty(q.extra)?c:q.extra;"function"===typeof m&&(m=m());var u={id:d.attr("id"),key:l,extra:m};var r=h.extend(!0,{},{url:k,type:"POST",dataType:"json",data:h.extend(!0,{},{key:l},m),beforeSend:function(b){a.ajaxAborted=!1;a._raise("filepredelete",[l,b,m]);a.ajaxAborted?b.abort():(e.addCss(n,"file-uploading"),e.addCss(d,"disabled"))},success:function(c,g,h){if(e.isEmpty(c)||e.isEmpty(c.error)){p=parseInt(n.attr("data-fileindex").replace("init_",
""));a.previewCache.unset(p);var k=a.previewCache.count();c=0<k?a._getMsgSelected(k):"";a._deleteFileIndex(n);a._setCaption(c);a._raise("filedeleted",[l,h,m]);n.removeClass("file-uploading").addClass("file-deleted");n.fadeOut("slow",function(){e.cleanZoomCache(b.find("#zoom-"+n.attr("id")));a._clearObjects(n);n.remove();f();k||0!==a.getFileStack().length||(a._setCaption(""),a.reset())})}else u.jqXHR=h,u.response=c,a._showError(c.error,u,"filedeleteerror"),n.removeClass("file-uploading"),d.removeClass("disabled"),
f()},error:function(b,c,d){c=a._parseError(a.ajaxOperations.deleteThumb,b,d);u.jqXHR=b;u.response={};a._showError(c,u,"filedeleteerror");n.removeClass("file-uploading");f()}},a.ajaxDeleteSettings);a._handler(d,"click",function(){if(!a._validateMinCount())return!1;h.ajax(r)})}})},_hideFileIcon:function(){this.overwriteInitial&&this.$captionContainer.find(".kv-caption-icon").hide()},_showFileIcon:function(){this.$captionContainer.find(".kv-caption-icon").show()},_getSize:function(a){var b=parseFloat(a),
c=this.fileSizeGetter;if(!h.isNumeric(a)||!h.isNumeric(b))return"";"function"===typeof c?b=c(b):0===b?b="0.00 B":(a=Math.floor(Math.log(b)/Math.log(1024)),c="B KB MB GB TB PB EB ZB YB".split(" "),b=1*(b/Math.pow(1024,a)).toFixed(2)+" "+c[a]);return this._getLayoutTemplate("size").replace("{sizeText}",b)},_generatePreviewTemplate:function(a,b,c,d,f,g,k,l,n,q,p){var m=this,u=m.slug(c),r="",t=m.previewSettings[a]||m.defaults.previewSettings[a],w=t&&t.width?t.width:"",y=t&&t.height?t.height:"",E=n||m._renderFileFooter(u,
k,e.isEmpty(w)?"auto":w,g);k=m._getPreviewIcon(c);var F="type-default";g=k&&m.preferIconicPreview;k=k&&m.preferIconicZoomPreview;n=function(b,g,k,n){var r=k?"zoom-"+f:f,t=m._getPreviewTemplate(b);n=(l||"")+" "+n;m.frameClass&&(n=m.frameClass+" "+n);k&&(n=n.replace(" "+e.SORT_CSS,""));t=m._parseFilePreviewIcon(t,c);"text"===b&&(g=e.htmlEncode(g));"object"!==a||d||h.each(m.defaults.fileTypeSettings,function(a,b){"object"!==a&&"other"!==a&&b(c,d)&&(F="type-"+a)});return t.setTokens({previewId:r,caption:u,
frameClass:n,type:d,fileindex:q,width:w,height:y,typeCss:F,footer:E,data:g,template:p||a})};q=q||f.slice(f.lastIndexOf("-")+1);m.fileActionSettings.showZoom&&(r=n(k?"other":a,b,!0,"kv-zoom-thumb"));r="\n"+m._getLayoutTemplate("zoomCache").replace("{zoomContent}",r);return n(g?"other":a,b,!1,"kv-preview-thumb")+r},_previewDefault:function(a,b,c){var d=this.$preview;if(this.showPreview){var f=a?a.name:"",g=a?a.type:"",k=a.size||0,l=this.slug(f),n=!0===c&&!this.isUploadable;a=e.objUrl.createObjectURL(a);
this._clearDefaultPreview();f=this._generatePreviewTemplate("other",a,f,g,b,n,k);d.append("\n"+f);this._setThumbAttr(b,l,k);!0===c&&this.isUploadable&&this._setThumbStatus(h("#"+b),"Error")}},_previewFile:function(a,b,c,d,f){if(this.showPreview){var g=this;a=g._parseFileType(b);var h=b?b.name:"",l=g.slug(h),n=g.allowedPreviewTypes,q=g.allowedPreviewMimeTypes,p=g.$preview,n=n&&0<=n.indexOf(a),m=b.size||0,u=b.type,r="text"===a||"html"===a||"image"===a?c.target.result:f;c=q&&-1!==q.indexOf(u);"html"===
a&&g.purifyHtml&&window.DOMPurify&&(r=window.DOMPurify.sanitize(r));if(n||c){c=g._generatePreviewTemplate(a,r,h,u,d,!1,m);g._clearDefaultPreview();p.append("\n"+c);var t=p.find("#"+d+" img");t.length&&g.autoOrientImage?e.validateOrientation(b,function(a){if(a){var c=p.find("#zoom-"+d+" img"),f="rotate-"+a;4<a&&(f+=t.width()>t.height()?" is-portrait-gt4":" is-landscape-gt4");e.addCss(t,f);e.addCss(c,f);g._raise("fileimageoriented",{$img:t,file:b})}g._validateImage(d,l,u,m,r);e.adjustOrientedImage(t)}):
g._validateImage(d,l,u,m,r)}else g._previewDefault(b,d);g._setThumbAttr(d,l,m);g._initSortable()}},_setThumbAttr:function(a,b,c){a=h("#"+a);a.length&&(c=c&&0<c?this._getSize(c):"",a.data({caption:b,size:c}))},_setInitThumbAttr:function(){var a=this.previewCache.data,b=this.previewCache.count(!0);if(0!==b)for(var c=0;c<b;c++){var d=a.config[c];var f=this.previewInitId+"-init_"+c;var g=e.ifSet("caption",d,e.ifSet("filename",d));d=e.ifSet("size",d);this._setThumbAttr(f,g,d)}},_slugDefault:function(a){return e.isEmpty(a)?
"":String(a).replace(/[\-\[\]\/\{}:;#%=\(\)\*\+\?\\\^\$\|<>&"']/g,"_")},_readFiles:function(a){this.reader=new FileReader;var b=this,c=b.$element,d=b.$preview,f=b.reader,g=b.$previewContainer,k=b.$previewStatus,l=b.msgLoading,n=b.msgProgress,q=b.previewInitId,p=a.length,m=b.fileTypeSettings,u=b.filestack.length,r=b.allowedFileTypes,t=r?r.length:0,w=b.allowedFileExtensions,y=e.isEmpty(w)?"":w.join(", "),E=b.maxFilePreviewSize&&parseFloat(b.maxFilePreviewSize),F=d.length&&(!E||isNaN(E)),G=function(c,
d,f,e){var g=h.extend(!0,{},b._getOutData({},{},a),{id:f,index:e}),k={id:f,index:e,file:d,files:a};b._previewDefault(d,f,!0);b.isUploadable&&(b.addToStack(void 0),setTimeout(function(){D(e+1)},100));b._initFileActions();b.removeFromPreviewOnError&&h("#"+f).remove();return b.isUploadable?b._showUploadError(c,g):b._showError(c,k)};b.loadedImages=[];b.totalImagesCount=0;h.each(a,function(a,c){var d=b.fileTypeSettings.image;d&&d(c.type)&&b.totalImagesCount++});var D=function(h){e.isEmpty(c.attr("multiple"))&&
(p=1);if(h>=p)b.isUploadable&&0<b.filestack.length?b._raise("filebatchselected",[b.getFileStack()]):b._raise("filebatchselected",[a]),g.removeClass("file-thumb-loading"),k.html("");else{var B=q+"-"+(u+h),v=a[h],z,A=v.name?b.slug(v.name):"";var J=(v.size||0)/1E3;var K="",I=e.objUrl.createObjectURL(v);var H=0;var L="";if(0<t)for(z=0;z<t;z++){var C=r[z];C=b.msgFileTypes[C]||C;L+=0===z?C:", "+C}if(!1===A)D(h+1);else if(0===A.length){var x=b.msgInvalidFileName.replace("{name}",e.htmlEncode(v.name));b.isError=
G(x,v,B,h)}else if(e.isEmpty(w)||(K=new RegExp("\\.("+w.join("|")+")$","i")),z=J.toFixed(2),0<b.maxFileSize&&J>b.maxFileSize)x=b.msgSizeTooLarge.setTokens({name:A,size:z,maxSize:b.maxFileSize}),b.isError=G(x,v,B,h);else if(null!==b.minFileSize&&J<=e.getNum(b.minFileSize))x=b.msgSizeTooSmall.setTokens({name:A,size:z,minSize:b.minFileSize}),b.isError=G(x,v,B,h);else{if(!e.isEmpty(r)&&e.isArray(r)){for(z=0;z<r.length;z+=1)C=r[z],C=m[C],H+=C&&"function"===typeof C?C(v.type,v.name)?1:0:0;if(0===H){x=b.msgInvalidFileType.setTokens({name:A,
types:L});b.isError=G(x,v,B,h);return}}if(0===H&&!e.isEmpty(w)&&e.isArray(w)&&!e.isEmpty(K)&&(K=e.compare(A,K),H+=e.isEmpty(K)?0:K.length,0===H)){x=b.msgInvalidFileExtension.setTokens({name:A,extensions:y});b.isError=G(x,v,B,h);return}b.showPreview?!F&&J>E?(b.addToStack(v),g.addClass("file-thumb-loading"),b._previewDefault(v,B),b._initFileActions(),b._updateFileDetails(p),D(h+1)):(d.length&&void 0!==FileReader?(k.html(l.replace("{index}",h+1).replace("{files}",p)),g.addClass("file-thumb-loading"),
f.onerror=function(a){b._errorHandler(a,A)},f.onload=function(a){b._previewFile(h,v,a,B,I);b._initFileActions()},f.onloadend=function(){x=n.setTokens({index:h+1,files:p,percent:50,name:A});setTimeout(function(){k.html(x);b._updateFileDetails(p);D(h+1)},100);b._raise("fileloaded",[v,B,h,f])},f.onprogress=function(a){a.lengthComputable&&(x=n.setTokens({index:h+1,files:p,percent:Math.ceil(a.loaded/a.total*100),name:A}),setTimeout(function(){k.html(x)},100))},J=m.text,H=m.image,J(v.type,A)?f.readAsText(v,
b.textEncoding):H(v.type,A)?f.readAsDataURL(v):f.readAsArrayBuffer(v)):(b._previewDefault(v,B),setTimeout(function(){D(h+1);b._updateFileDetails(p)},100),b._raise("fileloaded",[v,B,h,f])),b.addToStack(v)):(b.isUploadable&&b.addToStack(v),setTimeout(function(){D(h+1);b._updateFileDetails(p)},100),b._raise("fileloaded",[v,B,h,f]))}}};D(0);b._updateFileDetails(p,!1)},_updateFileDetails:function(a){var b=this.$element,c=this.getFileStack(),b=e.isIE(9)&&e.findFileName(b.val())||b[0].files[0]&&b[0].files[0].name||
c.length&&c[0].name||"",b=this.slug(b),c=this.isUploadable?c.length:a,d=this.previewCache.count()+c,c=1<c?this._getMsgSelected(d):b;this.isError?(this.$previewContainer.removeClass("file-thumb-loading"),this.$previewStatus.html(""),this.$captionContainer.find(".kv-caption-icon").hide()):this._showFileIcon();this._setCaption(c,this.isError);this.$container.removeClass("file-input-new file-input-ajax-new");1===arguments.length&&this._raise("fileselect",[a,b]);this.previewCache.count()&&this._initPreviewActions()},
_setThumbStatus:function(a,b){if(this.showPreview){var c="indicator"+b,d=c+"Title",f="file-preview-"+b.toLowerCase(),e=a.find(".file-upload-indicator"),h=this.fileActionSettings;a.removeClass("file-preview-success file-preview-error file-preview-loading");"Error"===b&&a.find(".kv-file-upload").attr("disabled",!0);"Success"===b&&(a.find(".file-drag-handle").remove(),e.css("margin-left",0));e.html(h[c]);e.attr("title",h[d]);a.addClass(f)}},_setProgressCancelled:function(){this._setProgress(101,this.$progress,
this.msgCancelled)},_setProgress:function(a,b,c){var d=Math.min(a,100),f=this.progressUploadThreshold,g=100>=a?this.progressTemplate:this.progressCompleteTemplate,g=100>d?this.progressTemplate:c?this.progressErrorTemplate:g;b=b||this.$progress;e.isEmpty(g)||(a=f&&d>f&&100>=a?g.setTokens({percent:f,status:this.msgUploadThreshold}):g.setTokens({percent:d,status:100<a?this.msgUploadEnd:d+"%"}),b.html(a),c&&b.find('[role="progressbar"]').html(c))},_setFileDropZoneTitle:function(){var a=this.$container.find(".file-drop-zone"),
b=this.dropZoneTitle;if(this.isClickable){var c=e.isEmpty(this.$element.attr("multiple"))?this.fileSingle:this.filePlural;b+=this.dropZoneClickTitle.replace("{files}",c)}a.find("."+this.dropZoneTitleClass).remove();this.isUploadable&&this.showPreview&&0!==a.length&&!(0<this.getFileStack().length)&&this.dropZoneEnabled&&(0===a.find(e.FRAMES).length&&e.isEmpty(this.defaultPreviewContent)&&a.prepend('<div class="'+this.dropZoneTitleClass+'">'+b+"</div>"),this.$container.removeClass("file-input-new"),
e.addCss(this.$container,"file-input-ajax-new"))},_setAsyncUploadStatus:function(a,b,c){var d=0;this._setProgress(b,h("#"+a).find(".file-thumb-progress"));this.uploadStatus[a]=b;h.each(this.uploadStatus,function(a,b){d+=b});this._setProgress(Math.floor(d/c))},_validateMinCount:function(){var a=this.isUploadable?this.getFileStack().length:this.$element.get(0).files.length;return this.validateInitialCount&&0<this.minFileCount&&this._getFileCount(a-1)<this.minFileCount?(this._noFilesError({}),!1):!0},
_getFileCount:function(a){if(this.validateInitialCount&&!this.overwriteInitial){var b=this.previewCache.count();a+=b}return a},_getFileId:function(a){var b=this.generateFileId;return"function"===typeof b?b(a,event):a?(b=a.webkitRelativePath||a.fileName||a.name||null)?a.size+"-"+b.replace(/[^0-9a-zA-Z_-]/img,""):null:null},_getFileName:function(a){return a&&a.name?this.slug(a.name):void 0},_getFileIds:function(a){return this.fileids.filter(function(b){return a?void 0!==b:void 0!==b&&null!==b})},_getFileNames:function(a){return this.filenames.filter(function(b){return a?
void 0!==b:void 0!==b&&null!==b})},_setPreviewError:function(a,b,c){void 0!==b&&this.updateStack(b,c);this.removeFromPreviewOnError?a.remove():this._setThumbStatus(a,"Error")},_checkDimensions:function(a,b,c,d,f,g,h){var k=this[("Small"===b?"min":"max")+"Image"+g];!e.isEmpty(k)&&c.length&&(c=c[0],c="Width"===g?c.naturalWidth||c.width:c.naturalHeight||c.height,("Small"===b?c>=k:c<=k)||(b=this["msgImage"+g+b].setTokens({name:f,size:k}),this._showUploadError(b,h),this._setPreviewError(d,a,null)))},_validateImage:function(a,
b,c,d,f){var e=this,k=e.$preview,l,n,q,p=k.find("#"+a),m=p.attr("data-fileindex"),u=p.find("img"),r;b=b||"Untitled";u.one("load",function(){n=p.width();q=k.width();n>q&&u.css("width","100%");l={ind:m,id:a};e._checkDimensions(m,"Small",u,p,b,"Width",l);e._checkDimensions(m,"Small",u,p,b,"Height",l);e.resizeImage||(e._checkDimensions(m,"Large",u,p,b,"Width",l),e._checkDimensions(m,"Large",u,p,b,"Height",l));e._raise("fileimageloaded",[a]);r=window.piexif?window.piexif.load(f):null;e.loadedImages.push({ind:m,
img:u,thumb:p,pid:a,typ:c,siz:d,validated:!1,imgData:f,exifObj:r});p.data("exif",r);e._validateAllImages()}).one("error",function(){e._raise("fileimageloaderror",[a])}).each(function(){this.complete?h(this).trigger("load"):this.error&&h(this).trigger("error")})},_validateAllImages:function(){var a,b={val:0},c=this.loadedImages.length,d,f=this.resizeIfSizeMoreThan;if(c===this.totalImagesCount&&(this._raise("fileimagesloaded"),this.resizeImage))for(a=0;a<this.loadedImages.length;a++){var e=this.loadedImages[a];
e.validated||((d=e.siz)&&d>1E3*f&&this._getResizedImage(e,b,c),this.loadedImages[a].validated=!0)}},_getResizedImage:function(a,b,c){var d=this,f=h(a.img)[0],g=f.naturalWidth,k=f.naturalHeight,l=1,l=d.maxImageWidth||g,n=d.maxImageHeight||k,q=!(!g||!k),p=d.imageCanvas,m=d.imageCanvasContext,u=a.typ,r=a.pid,t=a.ind,w=a.thumb,y=a.exifObj;a=function(a,b,c){d.isUploadable?d._showUploadError(a,b,c):d._showError(a,b,c);d._setPreviewError(w,t)};if(!d.filestack[t]||!q||g<=l&&k<=n)if(q&&d.filestack[t]&&d._raise("fileimageresized",
[r,t]),b.val++,b.val===c&&d._raise("fileimagesresized"),!q){a(d.msgImageResizeError,{id:r,index:t},"fileimageresizeerror");return}u=u||d.resizeDefaultImageType;q=g>l;var E=k>n;l="width"===d.resizePreference?q?l/g:E?n/k:1:E?n/k:q?l/g:1;d._resetCanvas();g*=l;k*=l;p.width=g;p.height=k;try{m.drawImage(f,0,0,g,k);var F=p.toDataURL(u,d.resizeQuality);if(y){var G=window.piexif.dump(y);F=window.piexif.insert(G,F)}var D=e.dataURI2Blob(F);d.filestack[t]=D;d._raise("fileimageresized",[r,t]);b.val++;b.val===
c&&d._raise("fileimagesresized",[void 0,void 0]);D instanceof Blob||a(d.msgImageResizeError,{id:r,index:t},"fileimageresizeerror")}catch(L){b.val++,b.val===c&&d._raise("fileimagesresized",[void 0,void 0]),b=d.msgImageResizeException.replace("{errors}",L.message),a(b,{id:r,index:t},"fileimageresizeexception")}},_initBrowse:function(a){this.showBrowse?(this.$btnFile=a.find(".btn-file"),this.$btnFile.append(this.$element)):this.$element.hide()},_initCaption:function(){var a=this.initialCaption||"";if(this.overwriteInitial||
e.isEmpty(a))return this.$caption.html(""),!1;this._setCaption(a);return!0},_setCaption:function(a,b){var c=this.getFileStack();if(this.$caption.length){if(b){var d=h("<div>"+this.msgValidationError+"</div>").text();var f=(f=c.length)?1===f&&c[0]?this._getFileNames()[0]:this._getMsgSelected(f):this._getMsgSelected(this.msgNo);f='<span class="'+this.msgValidationErrorClass+'">'+this.msgValidationErrorIcon+(e.isEmpty(a)?f:a)+"</span>"}else{if(e.isEmpty(a))return;d=h("<div>"+a+"</div>").text();f=this._getLayoutTemplate("fileIcon")+
d}this.$caption.html(f);this.$caption.attr("title",d);this.$captionContainer.find(".file-caption-ellipsis").attr("title",d)}},_createContainer:function(){var a={"class":"file-input file-input-new"+(this.rtl?" kv-rtl":"")},a=h(document.createElement("div")).attr(a).html(this._renderMain());this.$element.before(a);this._initBrowse(a);this.theme&&a.addClass("theme-"+this.theme);return a},_refreshContainer:function(){var a=this.$container;a.before(this.$element);a.html(this._renderMain());this._initBrowse(a)},
_renderMain:function(){var a=this.isUploadable&&this.dropZoneEnabled?" file-drop-zone":"file-drop-disabled",b=this.showClose?this._getLayoutTemplate("close"):"",a=this.showPreview?this._getLayoutTemplate("preview").setTokens({"class":this.previewClass,dropClass:a}):"",c=this.captionTemplate.setTokens({"class":(this.isDisabled?this.captionClass+" file-caption-disabled":this.captionClass)+" kv-fileinput-caption"});return this.mainTemplate.setTokens({"class":this.mainClass+(!this.showBrowse&&this.showCaption?
" no-browse":""),preview:a,close:b,caption:c,upload:this._renderButton("upload"),remove:this._renderButton("remove"),cancel:this._renderButton("cancel"),browse:this._renderButton("browse")})},_renderButton:function(a){var b=this._getLayoutTemplate("btnDefault"),c=this[a+"Class"],d=this[a+"Title"],f=this[a+"Icon"],g=this[a+"Label"],h=this.isDisabled?" disabled":"",l="button";switch(a){case "remove":if(!this.showRemove)return"";break;case "cancel":if(!this.showCancel)return"";c+=" hide";break;case "upload":if(!this.showUpload)return"";
this.isUploadable&&!this.isDisabled?b=this._getLayoutTemplate("btnLink").replace("{href}",this.uploadUrl):l="submit";break;case "browse":if(!this.showBrowse)return"";b=this._getLayoutTemplate("btnBrowse");break;default:return""}c+="browse"===a?" btn-file":" fileinput-"+a+" fileinput-"+a+"-button";e.isEmpty(g)||(g=' <span class="'+this.buttonLabelClass+'">'+g+"</span>");return b.setTokens({type:l,css:c,title:d,status:h,icon:f,label:g})},_renderThumbProgress:function(){return'<div class="file-thumb-progress hide">'+
this.progressTemplate.setTokens({percent:"0",status:this.msgUploadBegin})+"</div>"},_renderFileFooter:function(a,b,c,d){var f=this.fileActionSettings,g=f.showRemove,h=f.showDrag,l=f.showUpload,n=f.showZoom,q=this._getLayoutTemplate("footer"),p=d?f.indicatorError:f.indicatorNew;d=this._getLayoutTemplate("indicator").setTokens({indicator:p,indicatorTitle:d?f.indicatorErrorTitle:f.indicatorNewTitle});b=this._getSize(b);a=this.isUploadable?q.setTokens({actions:this._renderFileActions(l,g,n,h,!1,!1,!1),
caption:a,size:b,width:c,progress:this._renderThumbProgress(),indicator:d}):q.setTokens({actions:this._renderFileActions(!1,!1,n,h,!1,!1,!1),caption:a,size:b,width:c,progress:"",indicator:d});return a=e.replaceTags(a,this.previewThumbTags)},_renderFileActions:function(a,b,c,d,f,e,h,l){if(!(a||b||c||d))return"";e=!1===e?"":' data-url="'+e+'"';var g=!1===h?"":' data-key="'+h+'"',k=h="",p="",m="",u=this._getLayoutTemplate("actions"),r=this.fileActionSettings,t=this.otherActionButtons.setTokens({dataKey:g});
f=f?r.removeClass+" disabled":r.removeClass;b&&(h=this._getLayoutTemplate("actionDelete").setTokens({removeClass:f,removeIcon:r.removeIcon,removeTitle:r.removeTitle,dataUrl:e,dataKey:g}));a&&(k=this._getLayoutTemplate("actionUpload").setTokens({uploadClass:r.uploadClass,uploadIcon:r.uploadIcon,uploadTitle:r.uploadTitle}));c&&(p=this._getLayoutTemplate("actionZoom").setTokens({zoomClass:r.zoomClass,zoomIcon:r.zoomIcon,zoomTitle:r.zoomTitle}));d&&l&&(a="drag-handle-init "+r.dragClass,m=this._getLayoutTemplate("actionDrag").setTokens({dragClass:a,
dragTitle:r.dragTitle,dragIcon:r.dragIcon}));return u.setTokens({"delete":h,upload:k,zoom:p,drag:m,other:t})},_browse:function(a){this._raise("filebrowse");a&&a.isDefaultPrevented()||(this.isError&&!this.isUploadable&&this.clear(),this.$captionContainer.focus())},_filterDuplicate:function(a,b,c){var d=this._getFileId(a);d&&c&&-1<c.indexOf(d)||(c||(c=[]),b.push(a),c.push(d))},_change:function(a){var b=this,c=b.$element;if(!b.isUploadable&&e.isEmpty(c.val())&&b.fileInputCleared)b.fileInputCleared=!1;
else{b.fileInputCleared=!1;var d=[];var f=1<arguments.length;var g=b.isUploadable;var k=f?a.originalEvent.dataTransfer.files:c.get(0).files,l=b.filestack.length,n=e.isEmpty(c.attr("multiple"))&&0<l,q=0,p=b._getFileIds(),c=function(a,c,d,f){var e=h.extend(!0,{},b._getOutData({},{},k),{id:d,index:f});c={id:d,index:f,file:c,files:k};return b.isUploadable?b._showUploadError(a,e):b._showError(a,c)};b.reader=null;b._resetUpload();b._hideFileIcon();b.isUploadable&&b.$container.find(".file-drop-zone ."+b.dropZoneTitleClass).remove();
f?h.each(k,function(a,c){c&&!c.type&&void 0!==c.size&&0===c.size%4096?q++:b._filterDuplicate(c,d,p)}):(k=a.target&&void 0===a.target.files?a.target.value?[{name:a.target.value.replace(/^.+\\/,"")}]:[]:a.target.files||{},g?h.each(k,function(a,c){b._filterDuplicate(c,d,p)}):d=k);if(e.isEmpty(d)||0===d.length)g||b.clear(),b._showFolderError(q),b._raise("fileselectnone");else{b._resetErrors();var m=d.length;f=b._getFileCount(b.isUploadable?b.getFileStack().length+m:m);if(0<b.maxFileCount&&f>b.maxFileCount){if(!b.autoReplace||
m>b.maxFileCount){g=b.autoReplace&&m>b.maxFileCount?m:f;g=b.msgFilesTooMany.replace("{m}",b.maxFileCount).replace("{n}",g);b.isError=c(g,null,null,null);b.$captionContainer.find(".kv-caption-icon").hide();b._setCaption("",!0);b.$container.removeClass("file-input-new file-input-ajax-new");return}f>b.maxFileCount&&b._resetPreviewThumbs(g)}else!g||n?(b._resetPreviewThumbs(!1),n&&b.clearStack()):!g||0!==l||b.previewCache.count()&&!b.overwriteInitial||b._resetPreviewThumbs(!0);b.isPreviewable?b._readFiles(d):
b._updateFileDetails(1);b._showFolderError(q)}}},_abort:function(a){return this.ajaxAborted&&"object"===typeof this.ajaxAborted&&void 0!==this.ajaxAborted.message?(a=h.extend(!0,{},this._getOutData(),a),a.abortData=this.ajaxAborted.data||{},a.abortMessage=this.ajaxAborted.message,this._setProgress(101,this.$progress,this.msgCancelled),this._showUploadError(this.ajaxAborted.message,a,"filecustomerror"),this.cancel(),!0):!1},_resetFileStack:function(){var a=this,b=0,c=[],d=[],f=[];a._getThumbs().each(function(){var g=
h(this),k=g.attr("data-fileindex"),l=a.filestack[k],n=g.attr("id");"-1"!==k&&-1!==k&&(void 0!==l?(c[b]=l,d[b]=a._getFileName(l),f[b]=a._getFileId(l),g.attr({id:a.previewInitId+"-"+b,"data-fileindex":b}),b++):(k="uploaded-"+e.uniqId(),g.attr({id:k,"data-fileindex":"-1"}),a.$preview.find("#zoom-"+n).attr("id","zoom-"+k)))});a.filestack=c;a.filenames=d;a.fileids=f},_isFileSelectionValid:function(a){a=a||0;return this.required&&!this.getFilesCount()?(this.$errorContainer.html(""),this._showUploadError(this.msgFileRequired),
!1):0<this.minFileCount&&this._getFileCount(a)<this.minFileCount?(this._noFilesError({}),!1):!0},clearStack:function(){this.filestack=[];this.filenames=[];this.fileids=[];return this.$element},updateStack:function(a,b){this.filestack[a]=b;this.filenames[a]=this._getFileName(b);this.fileids[a]=b&&this._getFileId(b)||null;return this.$element},addToStack:function(a){this.filestack.push(a);this.filenames.push(this._getFileName(a));this.fileids.push(this._getFileId(a));return this.$element},getFileStack:function(a){return this.filestack.filter(function(b){return a?
void 0!==b:void 0!==b&&null!==b})},getFilesCount:function(){var a=this.isUploadable?this.getFileStack().length:this.$element.get(0).files.length;return this._getFileCount(a)},lock:function(){this._resetErrors();this.disable();this.showRemove&&e.addCss(this.$container.find(".fileinput-remove"),"hide");this.showCancel&&this.$container.find(".fileinput-cancel").removeClass("hide");this._raise("filelock",[this.filestack,this._getExtraData()]);return this.$element},unlock:function(a){void 0===a&&(a=!0);
this.enable();this.showCancel&&e.addCss(this.$container.find(".fileinput-cancel"),"hide");this.showRemove&&this.$container.find(".fileinput-remove").removeClass("hide");a&&this._resetFileStack();this._raise("fileunlock",[this.filestack,this._getExtraData()]);return this.$element},cancel:function(){var a=this,b=a.ajaxRequests,c=b.length,d;if(0<c)for(d=0;d<c;d+=1)a.cancelling=!0,b[d].abort();a._setProgressCancelled();a._getThumbs().each(function(){var b=h(this),c=b.attr("data-fileindex");b.removeClass("file-uploading");
void 0!==a.filestack[c]&&(b.find(".kv-file-upload").removeClass("disabled").removeAttr("disabled"),b.find(".kv-file-remove").removeClass("disabled").removeAttr("disabled"));a.unlock()});return a.$element},clear:function(){var a=this;if(a._raise("fileclear")){a.$btnUpload.removeAttr("disabled");a._getThumbs().find("video,audio,img").each(function(){e.cleanMemory(h(this))});a._resetUpload();a.clearStack();a._clearFileInput();a._resetErrors(!0);if(a._hasInitialPreview())a._showFileIcon(),a._resetPreview(),
a._initPreviewActions(),a.$container.removeClass("file-input-new");else{a._getThumbs().each(function(){a._clearObjects(h(this))});a.isUploadable&&(a.previewCache.data={});a.$preview.html("");var b=!a.overwriteInitial&&0<a.initialCaption.length?a.initialCaption:"";a.$caption.html(b);a.$caption.attr("title","");e.addCss(a.$container,"file-input-new");a._validateDefaultPreview()}0===a.$container.find(e.FRAMES).length&&(a._initCaption()||a.$captionContainer.find(".kv-caption-icon").hide());a._hideFileIcon();
a._raise("filecleared");a.$captionContainer.focus();a._setFileDropZoneTitle();return a.$element}},reset:function(){if(this._raise("filereset"))return this._resetPreview(),this.$container.find(".fileinput-filename").text(""),e.addCss(this.$container,"file-input-new"),(this.getFrames().length||this.isUploadable&&this.dropZoneEnabled)&&this.$container.removeClass("file-input-new"),this._setFileDropZoneTitle(),this.clearStack(),this.formdata={},this.$element},disable:function(){this.isDisabled=!0;this._raise("filedisabled");
this.$element.attr("disabled","disabled");this.$container.find(".kv-fileinput-caption").addClass("file-caption-disabled");this.$container.find(".btn-file, .fileinput-remove, .fileinput-upload, .file-preview-frame button").attr("disabled",!0);this._initDragDrop();return this.$element},enable:function(){this.isDisabled=!1;this._raise("fileenabled");this.$element.removeAttr("disabled");this.$container.find(".kv-fileinput-caption").removeClass("file-caption-disabled");this.$container.find(".btn-file, .fileinput-remove, .fileinput-upload, .file-preview-frame button").removeAttr("disabled");
this._initDragDrop();return this.$element},upload:function(){var a=this.getFileStack().length;var b=!h.isEmptyObject(this._getExtraData());if(this.isUploadable&&!this.isDisabled&&this._isFileSelectionValid(a))if(this._resetUpload(),0!==a||b)if(this.$progress.removeClass("hide"),this.uploadCount=0,this.uploadStatus={},this.uploadLog=[],this.lock(),this._setProgress(2),0===a&&b)this._uploadExtraOnly();else if(a=this.filestack.length,this.hasInitData=!1,this.uploadAsync){b=this._getOutData();this._raise("filebatchpreupload",
[b]);this.fileBatchCompleted=!1;this.uploadCache={content:[],config:[],tags:[],append:!0};this.uploadAsyncCount=this.getFileStack().length;for(b=0;b<a;b++)this.uploadCache.content[b]=null,this.uploadCache.config[b]=null,this.uploadCache.tags[b]=null;this.$preview.find(".file-preview-initial").removeClass(e.SORT_CSS);this._initSortable();this.cacheInitialPreview=this.getPreview();for(b=0;b<a;b++)void 0!==this.filestack[b]&&this._uploadSingle(b,this.filestack,!0)}else return this._uploadBatch(),this.$element;
else this._showUploadError(this.msgUploadEmpty)},destroy:function(){var a=this.$form,b=this.$container,c=this.$element,d=this.namespace;h(document).off(d);h(window).off(d);a&&a.length&&a.off(d);this.isUploadable&&this._clearFileInput();this._cleanup();this._initPreviewCache();c.insertBefore(b).off(d).removeData();b.off().remove();return c},refresh:function(a){var b=this,c=b.$element;a=a?h.extend(!0,{},b.options,a):b.options;b.destroy();c.fileinput(a);b=c.data("fileinput");b.isUploadable&&b._clearFileInput();
c.val()&&c.trigger("change.fileinput");return c},zoom:function(a){a=this._getFrame(a);var b=this.$modal;a&&(e.initModal(b),b.html(this._getModalContent()),this._setZoomContent(a),b.modal("show"),this._initZoomButtons())},getExif:function(a){return(a=this._getFrame(a))&&a.data("exif")||null},getFrames:function(a){return this.$preview.find(e.FRAMES+(a||""))},getPreview:function(){return{content:this.initialPreview,config:this.initialPreviewConfig,tags:this.initialPreviewThumbTags}}};h.fn.fileinput=
function(a){if(e.hasFileAPISupport()||e.isIE(9)){var b=Array.apply(null,arguments),c=[];b.shift();this.each(function(){var d=h(this),f=d.data("fileinput"),g="object"===typeof a&&a,k=g.theme||d.data("theme"),l={},n={},q=g.language||d.data("language")||h.fn.fileinput.defaults.language||"en";f||(k&&(n=h.fn.fileinputThemes[k]||{}),"en"===q||e.isEmpty(h.fn.fileinputLocales[q])||(l=h.fn.fileinputLocales[q]||{}),f=h.extend(!0,{},h.fn.fileinput.defaults,n,h.fn.fileinputLocales.en,l,g,d.data()),f=new I(this,
f),d.data("fileinput",f));"string"===typeof a&&c.push(f[a].apply(f,b))});switch(c.length){case 0:return this;case 1:return c[0];default:return c}}};h.fn.fileinput.defaults={language:"en",showCaption:!0,showBrowse:!0,showPreview:!0,showRemove:!0,showUpload:!0,showCancel:!0,showClose:!0,showUploadedThumbs:!0,browseOnZoneClick:!1,autoReplace:!1,autoOrientImage:!0,required:!1,rtl:!1,generateFileId:null,previewClass:"",captionClass:"",frameClass:"krajee-default",mainClass:"file-caption-main",mainTemplate:null,
purifyHtml:!0,fileSizeGetter:null,initialCaption:"",initialPreview:[],initialPreviewDelimiter:"*$$*",initialPreviewAsData:!1,initialPreviewFileType:"image",initialPreviewConfig:[],initialPreviewThumbTags:[],previewThumbTags:{},initialPreviewShowDelete:!0,removeFromPreviewOnError:!1,deleteUrl:"",deleteExtraData:{},overwriteInitial:!0,previewZoomButtonIcons:{prev:'<i class="glyphicon glyphicon-triangle-left"></i>',next:'<i class="glyphicon glyphicon-triangle-right"></i>',toggleheader:'<i class="glyphicon glyphicon-resize-vertical"></i>',
fullscreen:'<i class="glyphicon glyphicon-fullscreen"></i>',borderless:'<i class="glyphicon glyphicon-resize-full"></i>',close:'<i class="glyphicon glyphicon-remove"></i>'},previewZoomButtonClasses:{prev:"btn btn-navigate",next:"btn btn-navigate",toggleheader:"btn btn-default btn-header-toggle",fullscreen:"btn btn-default",borderless:"btn btn-default",close:"btn btn-default"},preferIconicPreview:!1,preferIconicZoomPreview:!1,allowedPreviewTypes:void 0,allowedPreviewMimeTypes:null,allowedFileTypes:null,
allowedFileExtensions:null,defaultPreviewContent:null,customLayoutTags:{},customPreviewTags:{},previewFileIcon:'<i class="glyphicon glyphicon-file"></i>',previewFileIconClass:"file-other-icon",previewFileIconSettings:{},previewFileExtSettings:{},buttonLabelClass:"hidden-xs",browseIcon:'<i class="glyphicon glyphicon-folder-open"></i>&nbsp;',browseClass:"btn btn-primary",removeIcon:'<i class="glyphicon glyphicon-trash"></i>',removeClass:"btn btn-default",cancelIcon:'<i class="glyphicon glyphicon-ban-circle"></i>',
cancelClass:"btn btn-default",uploadIcon:'<i class="glyphicon glyphicon-upload"></i>',uploadClass:"btn btn-default",uploadUrl:null,uploadAsync:!0,uploadExtraData:{},zoomModalHeight:480,minImageWidth:null,minImageHeight:null,maxImageWidth:null,maxImageHeight:null,resizeImage:!1,resizePreference:"width",resizeQuality:.92,resizeDefaultImageType:"image/jpeg",resizeIfSizeMoreThan:0,minFileSize:0,maxFileSize:0,maxFilePreviewSize:25600,minFileCount:0,maxFileCount:0,validateInitialCount:!1,msgValidationErrorClass:"text-danger",
msgValidationErrorIcon:'<i class="glyphicon glyphicon-exclamation-sign"></i> ',msgErrorClass:"file-error-message",progressThumbClass:"progress-bar progress-bar-success progress-bar-striped active",progressClass:"progress-bar progress-bar-success progress-bar-striped active",progressCompleteClass:"progress-bar progress-bar-success",progressErrorClass:"progress-bar progress-bar-danger",progressUploadThreshold:99,previewFileType:"image",elCaptionContainer:null,elCaptionText:null,elPreviewContainer:null,
elPreviewImage:null,elPreviewStatus:null,elErrorContainer:null,errorCloseButton:'<span class="close kv-error-close">&times;</span>',slugCallback:null,dropZoneEnabled:!0,dropZoneTitleClass:"file-drop-zone-title",fileActionSettings:{},otherActionButtons:"",textEncoding:"UTF-8",ajaxSettings:{},ajaxDeleteSettings:{},showAjaxErrorDetails:!0};h.fn.fileinputLocales.en={fileSingle:"file",filePlural:"files",browseLabel:"Browse &hellip;",removeLabel:"Remove",removeTitle:"Clear selected files",cancelLabel:"Cancel",
cancelTitle:"Abort ongoing upload",uploadLabel:"Upload",uploadTitle:"Upload selected files",msgNo:"No",msgNoFilesSelected:"No files selected",msgCancelled:"Cancelled",msgZoomModalHeading:"Detailed Preview",msgFileRequired:"You must select a file to upload.",msgSizeTooSmall:'File "{name}" (<b>{size} KB</b>) is too small and must be larger than <b>{minSize} KB</b>.',msgSizeTooLarge:'File "{name}" (<b>{size} KB</b>) exceeds maximum allowed upload size of <b>{maxSize} KB</b>.',msgFilesTooLess:"You must select at least <b>{n}</b> {files} to upload.",
msgFilesTooMany:"Number of files selected for upload <b>({n})</b> exceeds maximum allowed limit of <b>{m}</b>.",msgFileNotFound:'File "{name}" not found!',msgFileSecured:'Security restrictions prevent reading the file "{name}".',msgFileNotReadable:'File "{name}" is not readable.',msgFilePreviewAborted:'File preview aborted for "{name}".',msgFilePreviewError:'An error occurred while reading the file "{name}".',msgInvalidFileName:'Invalid or unsupported characters in file name "{name}".',msgInvalidFileType:'Invalid type for file "{name}". Only "{types}" files are supported.',
msgInvalidFileExtension:'Invalid extension for file "{name}". Only "{extensions}" files are supported.',msgFileTypes:{image:"image",html:"HTML",text:"text",video:"video",audio:"audio",flash:"flash",pdf:"PDF",object:"object"},msgUploadAborted:"The file upload was aborted",msgUploadThreshold:"Processing...",msgUploadBegin:"Initializing...",msgUploadEnd:"Done",msgUploadEmpty:"No valid data available for upload.",msgValidationError:"Validation Error",msgLoading:"Loading file {index} of {files} &hellip;",
msgProgress:"Loading file {index} of {files} - {name} - {percent}% completed.",msgSelected:"{n} {files} selected",msgFoldersNotAllowed:"Drag & drop files only! {n} folder(s) dropped were skipped.",msgImageWidthSmall:'Width of image file "{name}" must be at least {size} px.',msgImageHeightSmall:'Height of image file "{name}" must be at least {size} px.',msgImageWidthLarge:'Width of image file "{name}" cannot exceed {size} px.',msgImageHeightLarge:'Height of image file "{name}" cannot exceed {size} px.',
msgImageResizeError:"Could not get the image dimensions to resize.",msgImageResizeException:"Error while resizing the image.<pre>{errors}</pre>",msgAjaxError:"Something went wrong with the {operation} operation. Please try again later!",msgAjaxProgressError:"{operation} failed",ajaxOperations:{deleteThumb:"file delete",uploadThumb:"file upload",uploadBatch:"batch file upload",uploadExtra:"form data upload"},dropZoneTitle:"Drag & drop files here &hellip;",dropZoneClickTitle:"<br>(or click to select {files})",
previewZoomButtonTitles:{prev:"View previous file",next:"View next file",toggleheader:"Toggle header",fullscreen:"Toggle full screen",borderless:"Toggle borderless mode",close:"Close detailed preview"}};h.fn.fileinput.Constructor=I;h(document).ready(function(){var a=h("input.file[type=file]");a.length&&a.fileinput()})});
